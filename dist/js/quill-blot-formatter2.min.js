!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("Quill")):"function"==typeof define&&define.amd?define(["Quill"],e):"object"==typeof exports?exports.QuillBlotFormatter2=e(require("Quill")):t.QuillBlotFormatter2=e(t.Quill)}(self,(t=>(()=>{"use strict";var e={744:t=>{var e=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===i}(t)}(t)};var i="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function s(t,e){return!1!==e.clone&&e.isMergeableObject(t)?l((i=t,Array.isArray(i)?[]:{}),t,e):t;var i}function o(t,e,i){return t.concat(e).map((function(t){return s(t,i)}))}function r(t){return Object.keys(t).concat(function(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter((function(e){return Object.propertyIsEnumerable.call(t,e)})):[]}(t))}function n(t,e){try{return e in t}catch(t){return!1}}function a(t,e,i){var o={};return i.isMergeableObject(t)&&r(t).forEach((function(e){o[e]=s(t[e],i)})),r(e).forEach((function(r){(function(t,e){return n(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))})(t,r)||(n(t,r)&&i.isMergeableObject(e[r])?o[r]=function(t,e){if(!e.customMerge)return l;var i=e.customMerge(t);return"function"==typeof i?i:l}(r,i)(t[r],e[r],i):o[r]=s(e[r],i))})),o}function l(t,i,r){(r=r||{}).arrayMerge=r.arrayMerge||o,r.isMergeableObject=r.isMergeableObject||e,r.cloneUnlessOtherwiseSpecified=s;var n=Array.isArray(i);return n===Array.isArray(t)?n?r.arrayMerge(t,i,r):a(t,i,r):s(i,r)}l.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce((function(t,i){return l(t,i,e)}),{})};var h=l;t.exports=h},797:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(1)),r=s(i(744)),n=s(i(402)),a=s(i(216)),l=s(i(806)),h=s(i(627)),c=(t,e)=>e;e.default=class{quill;options;currentSpec;specs;overlay;toolbar;sizeInfo;actions;startX=0;startY=0;constructor(t,e={}){if(this.quill=t,this.currentSpec=null,this.actions=[],t.options.readOnly)return this.options=n.default,this.toolbar=new h.default(this),this.specs=[],this.overlay=document.createElement("div"),void(this.sizeInfo=document.createElement("div"));this.options=(0,r.default)(n.default,e,{arrayMerge:c}),[this.overlay,this.sizeInfo]=this.createOverlay(),this.addEventListeners(),this.toolbar=new h.default(this),this.specs=this.options.specs.map((t=>new t(this))),this.specs.forEach((t=>t.init())),document.execCommand("enableObjectResizing",!1,"false"),this.quill.container.style.position=this.quill.container.style.position||"relative",this.registerCustomBlots(),this.keyboardBindings()}show(t){this.hide(),this.currentSpec=t,this.currentSpec.setSelection(),this.setUserSelect("none"),this.quill.container.appendChild(this.overlay),this.repositionOverlay(),this.createActions(t),this.toolbar.create(),document.addEventListener("pointerdown",this.onDocumentPointerDown)}hide(){this.currentSpec&&(this.currentSpec.onHide(),this.currentSpec=null,this.quill.container.removeChild(this.overlay),document.removeEventListener("pointerdown",this.onDocumentPointerDown),this.overlay.style.setProperty("display","none"),this.setUserSelect(""),this.destroyActions(),this.toolbar.destroy(),this.quill.emitter.emit(this.quill.constructor.events.TEXT_CHANGE,0,this.quill.getLength(),"api"))}update(){this.repositionOverlay(),this.actions.forEach((t=>t.onUpdate()))}createActions(t){this.actions=t.getActions().map((t=>(t.onCreate(),t)))}destroyActions(){this.actions.forEach((t=>t.onDestroy())),this.actions=[]}createOverlay(){const t=document.createElement("div");t.classList.add(this.options.overlay.className),this.options.overlay.style&&Object.assign(t.style,this.options.overlay.style),t.style.userSelect="none",t.style.setProperty("-webkit-user-select","none"),t.style.setProperty("-moz-user-select","none"),t.style.setProperty("-ms-user-select","none");const e=document.createElement("div");return this.options.overlay.sizeInfoStyle&&Object.assign(e.style,this.options.overlay.sizeInfoStyle),t.appendChild(e),[t,e]}addEventListeners(){this.overlay.addEventListener("wheel",this.passWheelEventThrough,{passive:!1}),this.overlay.addEventListener("touchstart",this.onTouchScrollStart,{passive:!1}),this.overlay.addEventListener("touchmove",this.onTouchScrollMove,{passive:!1}),this.overlay.addEventListener("contextmenu",(t=>{t.stopPropagation(),t.preventDefault()})),this.repositionOverlay=this.repositionOverlay.bind(this),this.quill.root.addEventListener("scroll",this.repositionOverlay),new ResizeObserver((()=>{this.repositionOverlay()})).observe(this.quill.root),this.quill.root.addEventListener("click",this.onClick)}repositionOverlay(){if(this.currentSpec){const t=this.currentSpec.getOverlayElement();if(t){const e=this.quill.container.getBoundingClientRect(),i=t.getBoundingClientRect();Object.assign(this.overlay.style,{display:"block",left:`${i.left-e.left-1+this.quill.container.scrollLeft}px`,top:`${i.top-e.top+this.quill.container.scrollTop}px`,width:`${i.width}px`,height:`${i.height}px`})}}}setUserSelect(t){["userSelect","mozUserSelect","webkitUserSelect","msUserSelect"].forEach((e=>{this.quill.root.style.setProperty(e,t),document.documentElement&&document.documentElement.style.setProperty(e,t)}))}onDocumentPointerDown=t=>{const e=t.target;this.quill.root.parentNode.contains(e)||e.closest("div[data-blot-formatter-modal]")||e.classList.contains("blot-formatter__proxy-image")||this.hide()};onClick=()=>{this.hide()};passWheelEventThrough=t=>{this.quill.root.scrollLeft+=t.deltaX,this.quill.root.scrollTop+=t.deltaY};onTouchScrollStart=t=>{if(1===t.touches.length){const e=t.touches[0];this.startX=e.clientX,this.startY=e.clientY}};onTouchScrollMove=t=>{if(1===t.touches.length){const e=t.touches[0],i=this.startX-e.clientX,s=this.startY-e.clientY,o=this.quill.root,r=0===o.scrollTop,n=o.scrollTop+o.clientHeight===o.scrollHeight,a=0===o.scrollLeft,l=o.scrollLeft+o.clientWidth===o.scrollWidth,h=Math.abs(s)>Math.abs(i),c=Math.abs(i)>Math.abs(s);let d=!1;h&&(r&&s<0||n&&s>0||(d=!0,o.scrollTop+=s)),c&&(a&&i<0||l&&i>0||(d=!0,o.scrollLeft+=i)),d&&t.preventDefault(),this.startX=e.clientX,this.startY=e.clientY}};onOverlayTouchScrollMove=t=>{this.onTouchScrollMove(t),this.repositionOverlay()};registerCustomBlots(){this.options.image.registerImageTitleBlot&&o.default.register(a.default,!0),this.options.video.registerCustomVideoBlot&&(l.default.aspectRatio=this.options.video.defaultAspectRatio,o.default.register(l.default,!0))}keyboardBindings(){this.options.video.registerBackspaceFix&&(this.quill.keyboard.bindings.Backspace||(this.quill.keyboard.bindings.Backspace=[]),this.quill.keyboard.bindings.Backspace.unshift({key:"Backspace",empty:!0,line:{domNode:{tagName:"IFRAME"}},handler:t=>{this.quill.deleteText(t.index-1,1,"user")}})),this.options.image.registerArrowRightFix&&(this.quill.keyboard.bindings.ArrowRight||(this.quill.keyboard.bindings.ArrowRight=[]),this.quill.keyboard.bindings.ArrowRight.unshift({key:"ArrowRight",collapsed:!0,empty:!1,suffix:/^$/,line:{domNode:{tagName:"P"}},handler:(t,e)=>{this.quill.setSelection(t.index+t.length+1,0,"user")}}))}useRelative(t){if(this.options.resize.allowResizeModeChange){const e=t.getAttribute("width");return e?e.endsWith("%"):this.options.resize.useRelativeSize}return this.options.resize.useRelativeSize}}},402:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(329)),r=s(i(643)),n={specs:[o.default,r.default],overlay:{className:"blot-formatter__overlay",style:{position:"absolute",boxSizing:"border-box",border:"1px dashed #444",backgroundColor:"rgba(255, 255, 255, 0.35)",maxWidth:"100%"},sizeInfoStyle:{position:"absolute",color:"rgba(255, 255, 255, 0.7)",backgroundColor:"rgba(0, 0, 0, 0.7)",top:"50%",left:"50%",transform:"translate(-50%, -50%)",padding:"1em",textWrap:"nowrap",fontSize:"1rem",opacity:0,lineHeight:1.2}},align:{allowAligning:!0,alignments:["left","center","right"]},resize:{allowResizing:!0,allowResizeModeChange:!1,imageOversizeProtection:!1,handleClassName:"blot-formatter__resize-handle",handleStyle:{position:"absolute",height:"12px",width:"12px",backgroundColor:"white",border:"1px solid #777",boxSizing:"border-box",opacity:"0.80"},useRelativeSize:!1,minimumWidthPx:25},delete:{allowKeyboardDelete:!0},toolbar:{icons:{left:'\n        <svg viewbox="0 0 18 18">\n          <line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"></line>\n          <line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"></line>\n          <line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"></line>\n        </svg>\n      ',center:'\n        <svg viewbox="0 0 18 18">\n          <line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"></line>\n          <line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"></line>\n          <line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"></line>\n        </svg>\n      ',right:'\n        <svg viewbox="0 0 18 18">\n          <line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"></line>\n          <line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"></line>\n          <line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"></line>\n        </svg>\n      ',attribute:'\n        <svg viewBox="0 0 24 24" fill="none" class="ql-stroke">\n          <path d="M10 19H12M12 19H14M12 19V5M12 5H6V6M12 5H18V6" stroke-linecap="round" stroke-linejoin="round"/>\n        </svg>\n      ',resizeMode:'\n        <svg viewBox="0 0 24 24" class="ql-stroke">\n          <path\n            d="m 7.7056591,11.853515 q -1.515179,0 -2.4160962,-0.993056 -0.9009172,-1.0032944 -0.9009172,-2.6720388 0,-1.8223098 0.9521057,-2.8665548 0.9521057,-1.0544826 2.5696616,-1.0544826 1.5663674,0 2.426334,0.9725811 0.870204,0.972581 0.870204,2.7334647 0,1.7608836 -0.972581,2.8256044 -0.9623435,1.054482 -2.5287109,1.054482 z M 7.8489868,5.3935293 q -0.9725811,0 -1.5356544,0.7268764 -0.5630732,0.7166387 -0.5630732,1.9758752 0,1.2387612 0.5528356,1.9349241 0.5528355,0.685926 1.5049412,0.685926 0.9623434,0 1.5049413,-0.716639 0.5425978,-0.7166384 0.5425978,-1.9861126 0,-1.2387612 -0.5425978,-1.9246868 Q 8.7806171,5.3935293 7.8489868,5.3935293 Z M 17.533847,4.4926121 8.1151669,19.275845 H 6.6511764 L 16.059619,4.4926121 Z M 16.448651,19.398697 q -1.515179,0 -2.416096,-1.003294 -0.900917,-1.003294 -0.900917,-2.661801 0,-1.82231 0.962343,-2.876793 0.962344,-1.06472 2.559424,-1.06472 1.55613,0 2.426334,0.982819 0.870204,0.982819 0.870204,2.75394 0,1.750646 -0.972581,2.815366 -0.962343,1.054483 -2.528711,1.054483 z m 0.143328,-6.449748 q -0.982819,0 -1.545892,0.716638 -0.552836,0.716639 -0.552836,1.986113 0,1.218286 0.552836,1.914449 0.552835,0.685926 1.504941,0.685926 0.962343,0 1.504941,-0.716639 0.542598,-0.726876 0.542598,-1.986113 0,-1.248998 -0.542598,-1.924686 -0.53236,-0.675688 -1.46399,-0.675688 z"\n            style="fill:currentColor;stroke:currentColor;stroke-width:0.3"\n          />\n        </svg>\n      ',compress:'\n        <svg viewBox="0 0 28 28">\n            <path d="m 19.250001,9.3125004 c 0.240623,0 0.437498,0.1968749 0.437498,0.4374991 V 18.49453 l -0.136717,-0.177734 -3.718751,-4.812498 c -0.123046,-0.161329 -0.317188,-0.254297 -0.51953,-0.254297 -0.202345,0 -0.39375,0.09297 -0.519532,0.254297 l -2.269532,2.936715 -0.833984,-1.167577 c -0.123047,-0.172265 -0.319922,-0.273437 -0.533204,-0.273437 -0.213281,0 -0.410156,0.101172 -0.533202,0.276172 l -2.1875003,3.0625 -0.1230462,0.169532 v -0.0082 -8.7500002 c 0,-0.2406242 0.1968749,-0.4374991 0.4374991,-0.4374991 z M 8.7499996,8 C 7.7847663,8 7,8.7847662 7,9.7499995 V 18.5 c 0,0.965233 0.7847663,1.75 1.7499996,1.75 H 19.250001 C 20.215235,20.25 21,19.465233 21,18.5 V 9.7499995 C 21,8.7847662 20.215235,8 19.250001,8 Z M 10.9375,13.250001 a 1.3125025,1.312501 0 1 0 0,-2.625002 1.3125025,1.312501 0 1 0 0,2.625002 z" />\n            <path d="m 25.298508,20 h -3.58209 C 21.286567,20 21,20.286571 21,20.716427 v 3.582131 c 0,0.429856 0.286567,0.716426 0.716418,0.716426 v 0 c 0.429851,0 0.716418,-0.28657 0.716418,-0.716426 v -2.865705 h 2.865672 c 0.429851,0 0.716418,-0.28657 0.716418,-0.716426 C 26.014926,20.286571 25.728359,20 25.298508,20 Z" />\n            <path d="M 6.298508,20 H 2.716418 C 2.2865673,20 2,20.286571 2,20.716427 c 0,0.429856 0.2865673,0.716426 0.716418,0.716426 H 5.58209 v 2.865705 c 0,0.429856 0.286567,0.716426 0.716418,0.716426 v 0 c 0.429851,0 0.716418,-0.28657 0.716418,-0.716426 V 20.716427 C 7.014926,20.286571 6.728359,20 6.298508,20 Z" />\n            <path d="M 6.298507,3 C 5.868656,3 5.582089,3.28657 5.582089,3.716426 V 6.582131 H 2.716417 C 2.286567,6.582131 2,6.868702 2,7.298557 2,7.728413 2.286567,8.014984 2.716417,8.014984 h 3.58209 c 0.429845,0 0.716412,-0.286571 0.716412,-0.716427 V 3.716426 C 7.014919,3.28657 6.728352,3 6.298507,3 Z" />\n            <path d="m 21.716418,8.014984 h 3.582089 c 0.429851,0 0.716418,-0.286571 0.716418,-0.716427 0,-0.429855 -0.286567,-0.716426 -0.716418,-0.716426 H 22.432836 V 3.716426 C 22.432836,3.28657 22.146269,3 21.716418,3 21.286567,3 21,3.28657 21,3.716426 v 3.582131 c 0,0.429856 0.286567,0.716427 0.716418,0.716427 z" />\n        </svg>\n      '},mainClassName:"blot-formatter__toolbar",mainStyle:{position:"absolute",display:"flex",top:"0",right:"0",left:"0",transform:"translateY(-50%)",justifyContent:"center",flexWrap:"wrap",color:"#333",zIndex:"1"},buttonClassName:"blot-formatter__toolbar-button",buttonStyle:{display:"inline-block",width:"27px",height:"26px",background:"white",border:"1px solid #999",cursor:"pointer",margin:"0 -1px 0 0"},svgStyle:{display:"inline-block",width:"100%",height:"100%",background:"white",verticalAlign:"top"}},image:{allowAltTitleEdit:!0,registerImageTitleBlot:!1,registerArrowRightFix:!0,altTitleModalOptions:{styles:{modalBackground:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},modalContainer:{backgroundColor:"#f2f2f2",padding:"5px 10px 10px 10px",borderRadius:"5px",position:"relative",width:"90%",maxWidth:"500px"},label:{display:"block",color:"black",margin:"10px 0 5px 0",fontSize:"0.9em"},textarea:{backgroundColor:"white",display:"block",resize:"none",width:"100%",padding:"5px"},submitButton:{display:"block",marginLeft:"auto",marginTop:"5px",cursor:"pointer",border:0,padding:0,width:"2.5rem",height:"2.5rem",fill:"green"},cancelButton:{display:"flex",width:"2rem",height:"2rem",position:"absolute",top:"-0.7rem",right:"-0.7rem",background:"white",border:"1px solid gray",borderRadius:"5px",cursor:"pointer",alignItems:"center",fill:"red"}},icons:{submitButton:'\n        <svg viewBox="0 0 24 24">\n          <path fill-rule="evenodd" clip-rule="evenodd" d="M12 22C7.28595 22 4.92893 22 3.46447 20.5355C2 19.0711 2 16.714 2 12C2 7.28595 2 4.92893 3.46447 3.46447C4.92893 2 7.28595 2 12 2C16.714 2 19.0711 2 20.5355 3.46447C22 4.92893 22 7.28595 22 12C22 16.714 22 19.0711 20.5355 20.5355C19.0711 22 16.714 22 12 22ZM16.0303 8.96967C16.3232 9.26256 16.3232 9.73744 16.0303 10.0303L11.0303 15.0303C10.7374 15.3232 10.2626 15.3232 9.96967 15.0303L7.96967 13.0303C7.67678 12.7374 7.67678 12.2626 7.96967 11.9697C8.26256 11.6768 8.73744 11.6768 9.03033 11.9697L10.5 13.4393L14.9697 8.96967C15.2626 8.67678 15.7374 8.67678 16.0303 8.96967Z"></path>\n        </svg>',cancelButton:'\n        <svg viewBox="0 0 384 512">   \n            <path d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"/>\n        </svg>'},labels:{alt:"Alt Text",title:"Image Title"}},allowCompressor:!1,compressorOptions:{jpegQuality:.8,styles:{modalBackground:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},modalContainer:{backgroundColor:"#000000c7",padding:"15px",borderRadius:"8px",position:"relative",maxWidth:"min(90%, 400px)",border:"3px solid black",color:"lightgray",textAlign:"justify",userSelect:"none"},buttonContainer:{gridTemplateColumns:"auto 1fr auto",display:"grid",gap:"1em",justifyItems:"center",borderTop:"1px solid lightgray",paddingTop:"12px"},buttons:{width:"2rem",height:"2rem",padding:0,backgroundColor:"transparent",border:0,cursor:"pointer"}},text:{prompt:"<h5>Compress image to its resized width?</h5>",moreInfo:'\n              <p style="font-size: smaller; line-height: 1.2;">You can reduce the file size and save disk space by compressing pictures. The compression reduces both\n              the file size and picture dimensions based on the width setting.</p>\n              <p style="font-size: smaller;"><strong>NOTE:</strong> This process cannot be undone.</p>\n          ',reducedLabel:"Reduced",nothingToDo:"Image already optimised."},icons:{cancel:'\n              <svg viewBox="0 0 24 24" fill="#ea1414">\n                  <path d="M 3.4285714,0 C 1.5375,0 0,1.5375 0,3.4285714 V 20.571429 C 0,22.4625 1.5375,24 3.4285714,24 H 20.571429 C 22.4625,24 24,22.4625 24,20.571429 V 3.4285714 C 24,1.5375 22.4625,0 20.571429,0 Z m 4.2321429,7.6607143 c 0.5035714,-0.5035714 1.3178571,-0.5035714 1.8160714,0 L 11.994643,10.178571 14.5125,7.6607143 c 0.503571,-0.5035714 1.317857,-0.5035714 1.816071,0 0.498215,0.5035714 0.503572,1.3178571 0,1.8160714 l -2.517857,2.5178573 2.517857,2.517857 c 0.503572,0.503571 0.503572,1.317857 0,1.816071 -0.503571,0.498215 -1.317857,0.503572 -1.816071,0 l -2.517857,-2.517857 -2.5178573,2.517857 c -0.5035714,0.503572 -1.3178571,0.503572 -1.8160714,0 C 7.1625,15.825 7.1571429,15.010714 7.6607143,14.5125 L 10.178571,11.994643 7.6607143,9.4767857 c -0.5035714,-0.5035714 -0.5035714,-1.3178571 0,-1.8160714 z" />\n              </svg>',moreInfo:'\n              <svg viewBox="0 0 512 512" fill="royalblue">\n                  <path d="M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm169.8-90.7c7.9-22.3 29.1-37.3 52.8-37.3l58.3 0c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24l0-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1l-58.3 0c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z" />\n              </svg>',continue:'\n              <svg viewBox="0 0 24 24" fill="green">\n                  <path fill-rule="evenodd" clip-rule="evenodd"\n                      d="M 12,24 C 6.34314,24 3.514716,24 1.757364,22.2426 0,20.48532 0,17.6568 0,12 0,6.34314 0,3.514716 1.757364,1.757364 3.514716,0 6.34314,0 12,0 17.6568,0 20.48532,0 22.2426,1.757364 24,3.514716 24,6.34314 24,12 24,17.6568 24,20.48532 22.2426,22.2426 20.48532,24 17.6568,24 12,24 Z M 16.83636,8.363604 c 0.35148,0.351468 0.35148,0.921324 0,1.272756 l -6,6 c -0.35148,0.35148 -0.92124,0.35148 -1.272756,0 l -2.4,-2.4 c -0.351468,-0.35148 -0.351468,-0.92124 0,-1.27272 0.351468,-0.35148 0.921324,-0.35148 1.272792,0 L 10.2,13.72716 15.56364,8.363604 c 0.35148,-0.351468 0.92124,-0.351468 1.27272,0 z" />\n              </svg>'}}},video:{selector:"iframe.ql-video",registerCustomVideoBlot:!1,registerBackspaceFix:!0,defaultAspectRatio:"16/9 auto",proxyStyle:{}}};e.default=n},572:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default=class{formatter;toolbarButtons=[];constructor(t){this.formatter=t}onCreate(){}onDestroy(){}onUpdate(){}}},926:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(1)),r=s(i(572)),n=i(87),a=s(i(715));class l extends r.default{modal;targetElement=null;constructor(t){super(t),this.toolbarButtons=[new a.default("attribute",this.onClickHandler,this.formatter.options.toolbar)],this.modal=this.createModal()}onCreate(){this.targetElement=this.formatter.currentSpec?.getTargetElement()}onDestroy(){this.targetElement=null,this.modal.element.remove()}onClickHandler=()=>{this.showAltTitleModal()};showAltTitleModal(){this.targetElement&&(this.modal.altInput.value=this.targetElement.getAttribute("alt")||"",this.modal.titleInput.value=this.targetElement.getAttribute("title")||"",document.body.append(this.modal.element))}hideAltTitleModal(){this.modal.element.remove()}setAltTitle(){if(this.targetElement){const t=this.modal.altInput.value,e=this.modal.titleInput.value;t?this.targetElement.setAttribute("alt",t):this.targetElement.removeAttribute("alt"),e?this.targetElement.setAttribute("title",e):this.targetElement.removeAttribute("title");const i=o.default.find(this.targetElement),s=i?.parent?.formats()[n.ImageAlign.attrName]?.align;i&&s&&(i.parent?.format(n.ImageAlign.attrName,!1),i.format(n.ImageAlign.attrName,{align:s,title:e}))}}createModal(){const t=Array.from(crypto.getRandomValues(new Uint8Array(5)),(t=>String.fromCharCode(97+t%26))).join(""),e=document.createElement("div");e.id=`${t}-modal`,e.setAttribute("data-blot-formatter-modal","");const i=document.createElement("div"),s=document.createElement("form");s.id=`${t}-form`;const o=document.createElement("label");o.setAttribute("for","alt"),o.textContent=this.formatter.options.overlay.labels?.alt||this.formatter.options.image.altTitleModalOptions.labels.alt;const r=document.createElement("textarea");r.name="alt",r.rows=3;const n=document.createElement("label");n.setAttribute("for","title"),n.textContent=this.formatter.options.overlay.labels?.title||this.formatter.options.image.altTitleModalOptions.labels.title;const a=document.createElement("textarea");a.name="title",a.rows=3;const l=document.createElement("div"),h=document.createElement("button");h.type="submit",h.innerHTML=this.formatter.options.image.altTitleModalOptions.icons.submitButton,l.appendChild(h),s.appendChild(o),s.appendChild(r),s.appendChild(n),s.appendChild(a),s.appendChild(l);const c=document.createElement("button");return c.id=`${t}-cancel`,c.type="button",c.innerHTML=this.formatter.options.image.altTitleModalOptions.icons.cancelButton,this.formatter.options.image.altTitleModalOptions.styles&&(Object.assign(e.style,this.formatter.options.image.altTitleModalOptions.styles.modalBackground),Object.assign(i.style,this.formatter.options.image.altTitleModalOptions.styles.modalContainer),Object.assign(o.style,this.formatter.options.image.altTitleModalOptions.styles.label),Object.assign(r.style,this.formatter.options.image.altTitleModalOptions.styles.textarea),Object.assign(n.style,this.formatter.options.image.altTitleModalOptions.styles.label),Object.assign(a.style,this.formatter.options.image.altTitleModalOptions.styles.textarea),Object.assign(h.style,this.formatter.options.image.altTitleModalOptions.styles.submitButton),Object.assign(c.style,this.formatter.options.image.altTitleModalOptions.styles.cancelButton)),i.appendChild(s),i.appendChild(c),e.appendChild(i),s.addEventListener("submit",(t=>{t.preventDefault(),this.setAltTitle(),this.hideAltTitleModal()})),s.addEventListener("cancel",(()=>{this.hideAltTitleModal()})),e.addEventListener("pointerdown",(t=>{t.target===e&&this.hideAltTitleModal()})),c.addEventListener("click",(()=>{this.hideAltTitleModal()})),{element:e,form:s,altInput:r,titleInput:a,cancelButton:c}}}e.default=l},288:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(572)),r=s(i(715));class n extends o.default{options;modal;targetElement=null;imageDetails=null;constructor(t){super(t),this.options=this.formatter.options.image.compressorOptions,this.toolbarButtons=[new r.default("compress",this.onClickHandler,this.formatter.options.toolbar)],this.modal=this.createModal()}onCreate(){this.targetElement=this.formatter.currentSpec?.getTargetElement(),this.toolbarButtons[0].initialVisibility=n.isEligibleForCompression(this.targetElement)}onDestroy(){this.targetElement=null,this.hideModal()}onClickHandler=()=>{this.showModal()};showModal(){this.targetElement instanceof HTMLImageElement&&(this.imageDetails=this.getImageDetails(this.targetElement),this.imageDetails.canCompress?(this.modal.moreInfoButton.style.visibility="visible",this.modal.moreInfoText.style.display="none",document.body.append(this.modal.element)):this.displayFeedback(this.options.text.nothingToDo))}hideModal(){this.modal.element.remove()}static isEligibleForCompression(t){if(t instanceof HTMLImageElement&&t.src.startsWith("data:image/")){const e=t.src.substring(5,t.src.indexOf(";"));return"svg+xml"!==e&&"gif"!==e}return!1}parseDimensions(t){let e=t.getAttribute("width"),i=t.getAttribute("height"),s=null,o=null;if(e)if(e.toLowerCase().endsWith("px"))s=parseFloat(e);else if(e.endsWith("%"))s=this.options.maxWidth??null;else if(e.toLowerCase().endsWith("em")||e.toLowerCase().endsWith("rem"))s=16*parseFloat(e);else{if(isNaN(parseFloat(e)))return[null,null];s=parseFloat(e)}if(i)if(isNaN(parseFloat(i)))if(i.toLowerCase().endsWith("px"))o=parseFloat(i);else if(i.toLowerCase().endsWith("em")||i.toLowerCase().endsWith("rem"))o=16*parseFloat(i);else{if(!(s&&t.naturalWidth>0&&t.naturalHeight>0))return[null,null];o=s/(t.naturalWidth/t.naturalHeight)}else o=parseFloat(i);return[s,o]}getImageSize(t){const e=t.getAttribute("src");if(!e||!e.startsWith("data:image/"))return null;const i=e.split(",")[1];return i?Math.ceil(3*i.length/4):null}displayFeedback(t){this.formatter.sizeInfo.innerHTML=t,this.formatter.sizeInfo.style.transition="",this.formatter.sizeInfo.style.opacity="1",setTimeout((()=>{this.formatter.sizeInfo.style.transition="opacity 1s",this.formatter.sizeInfo.style.opacity="0"}),2500)}getImageDetails(t){let[e,i]=this.parseDimensions(t);return!e&&(this.options.maxWidth??1/0)<t.naturalWidth&&(e=this.options.maxWidth,i=e/(t.naturalWidth/t.naturalHeight)),{naturalWidth:t.naturalWidth,naturalHeight:t.naturalHeight,targetWidth:e,targetHeight:i,size:this.getImageSize(t),canCompress:!!(e&&i&&e<t.naturalWidth&&n.isEligibleForCompression(t))}}compressImage=t=>{if(this.imageDetails&&this.imageDetails.canCompress){const e=new Image;e.src=t.src,e.onload=()=>{const i=document.createElement("canvas");i.width=this.imageDetails.targetWidth,i.height=this.imageDetails.targetHeight;i.getContext("2d").drawImage(e,0,0,i.width,i.height);const s=i.toDataURL("image/jpeg",this.options.jpegQuality),o=(new TextEncoder).encode(t.src).length;(new TextEncoder).encode(s).length<o&&(t.src=s);const r=`${Math.ceil((this.imageDetails.size-this.getImageSize(t))/1024)}kB`,n=`${this.options.text.reducedLabel}: ${r}<br>\n                            ${this.imageDetails.naturalWidth} x ${this.imageDetails.naturalHeight}px â†’ ${i.width} x ${Math.round(i.height)}px\n                        `;return this.displayFeedback(n),!0},e.onerror=t=>(console.error("Image loading failed:",t),this.displayFeedback(`Image loading failed: ${t}`),!1)}else this.displayFeedback(this.options.text.nothingToDo);return!0};createModal(){const t=document.createElement("div");t.setAttribute("data-blot-formatter-compress-modal","");const e=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div"),o=document.createElement("div"),r=document.createElement("button"),n=document.createElement("button"),a=document.createElement("button");return s.style.display="none",o.append(r,n,a),e.append(i,s,o),t.appendChild(e),i.innerHTML=this.options.text.prompt,s.innerHTML=this.options.text.moreInfo||"",this.options.styles&&(Object.assign(t.style,this.options.styles.modalBackground),Object.assign(e.style,this.options.styles.modalContainer),Object.assign(o.style,this.options.styles.buttonContainer),Object.assign(r.style,this.options.styles.buttons),this.options.text.moreInfo?Object.assign(n.style,this.options.styles.buttons):n.style.visibility="hidden",Object.assign(a.style,this.options.styles.buttons)),r.innerHTML=this.options.icons.cancel,n.innerHTML=this.options.icons.moreInfo,a.innerHTML=this.options.icons.continue,a.addEventListener("click",(t=>{this.targetElement instanceof HTMLImageElement&&this.compressImage(this.targetElement),this.hideModal()})),n.addEventListener("click",(t=>{s.innerHTML=this.options.text.moreInfo||"",s.style.display="block",n.style.visibility="hidden"})),r.addEventListener("click",(()=>{this.hideModal()})),t.addEventListener("pointerdown",(e=>{e.stopImmediatePropagation(),e.target===t&&this.hideModal()})),{element:t,moreInfoButton:n,moreInfoText:s}}}e.default=n},751:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(1)),r=s(i(572));class n extends r.default{onCreate(){document.addEventListener("keyup",this.onKeyUp,!0),this.formatter.quill.root.addEventListener("input",this.onKeyUp,!0)}onDestroy(){document.removeEventListener("keyup",this.onKeyUp,!0),this.formatter.quill.root.removeEventListener("input",this.onKeyUp,!0)}onKeyUp=t=>{const e=!!document.querySelector("div[data-blot-formatter-modal]");if(this.formatter.currentSpec&&!e&&("Delete"===t.code||"Backspace"===t.code)){const t=this.formatter.currentSpec.getTargetElement();if(t){const e=o.default.find(t);if(e){const t=this.formatter.quill.getIndex(e);this.formatter.quill.deleteText(t,1,"user")}}this.formatter.hide()}}}e.default=n},108:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(572)),r=s(i(715));class n extends o.default{topLeftHandle;topRightHandle;bottomRightHandle;bottomLeftHandle;dragHandle=null;dragStartX=0;dragCursorStyle;preDragWidth=0;pinchStartDistance=0;calculatedAspectRatio=0;computedAspectRatio=void 0;target;editorStyle;editorWidth=0;useRelativeSize;resizeModeButton=null;isUnclickable=!1;hasResized=!1;formattedWidth="";sizeInfoTimerId=null;isImage=!1;isSVG=!1;naturalWidth=void 0;constructor(t){super(t),this.topLeftHandle=this.createHandle("top-left","nwse-resize"),this.topRightHandle=this.createHandle("top-right","nesw-resize"),this.bottomRightHandle=this.createHandle("bottom-right","nwse-resize"),this.bottomLeftHandle=this.createHandle("bottom-left","nesw-resize"),this.dragCursorStyle=document.createElement("style"),this.useRelativeSize=this.formatter.options.resize.useRelativeSize,t.options.resize.allowResizeModeChange&&(this.resizeModeButton=this.createResizeModeButton(),this.toolbarButtons=[this.resizeModeButton])}onCreate(){this.target=this.formatter.currentSpec?.getTargetElement(),this.isUnclickable=this.formatter.currentSpec?.isUnclickable||!1,this.isImage=this.target instanceof HTMLImageElement,this.isImage&&(this.isSVG=this.isSvgImage()),this.formatter.overlay.appendChild(this.topLeftHandle),this.formatter.overlay.appendChild(this.topRightHandle),this.formatter.overlay.appendChild(this.bottomRightHandle),this.formatter.overlay.appendChild(this.bottomLeftHandle),this.formatter.overlay.addEventListener("mousedown",this.onOverlayMouseDown),this.formatter.overlay.addEventListener("mouseup",this.onOverlayMouseUp),this.formatter.overlay.addEventListener("touchstart",this.onOverlayTouchStart,{passive:!1}),this.formatter.overlay.addEventListener("touchmove",this.onOverlayTouchMove,{passive:!1}),this.formatter.overlay.addEventListener("touchend",this.onOverlayTouchEnd,{passive:!1});const t=this.formatter.options.resize.handleStyle||{};this.repositionHandles(t)}onDestroy(){this.target=null,this.isUnclickable=!1,this.isImage=!1,this.naturalWidth=void 0,this.isSVG=!1,this.setCursor(""),this.formatter.overlay.removeChild(this.topLeftHandle),this.formatter.overlay.removeChild(this.topRightHandle),this.formatter.overlay.removeChild(this.bottomRightHandle),this.formatter.overlay.removeChild(this.bottomLeftHandle),this.formatter.overlay.removeEventListener("mousedown",this.onOverlayMouseDown),this.formatter.overlay.removeEventListener("mouseup",this.onOverlayMouseUp),this.formatter.overlay.removeEventListener("touchstart",this.onOverlayTouchStart,{passive:!1}),this.formatter.overlay.removeEventListener("touchmove",this.onOverlayTouchMove,{passive:!1}),this.formatter.overlay.removeEventListener("touchend",this.onOverlayTouchEnd,{passive:!1}),this.formatter.update()}createHandle(t,e){const i=document.createElement("div");return i.classList.add(this.formatter.options.resize.handleClassName),i.setAttribute("data-position",t),i.style.cursor=e,this.formatter.options.resize.handleStyle&&Object.assign(i.style,this.formatter.options.resize.handleStyle),i.addEventListener("pointerdown",this.onHandlePointerDown),i}repositionHandles(t){let e="0px",i="0px";t&&(t.width&&(e=-parseFloat(t.width)/2+"px"),t.height&&(i=-parseFloat(t.height)/2+"px")),Object.assign(this.topLeftHandle.style,{left:e,top:i}),Object.assign(this.topRightHandle.style,{right:e,top:i}),Object.assign(this.bottomRightHandle.style,{right:e,bottom:i}),Object.assign(this.bottomLeftHandle.style,{left:e,bottom:i})}setCursor(t){if(document.body)if(t)this.dragCursorStyle.innerHTML=`body, body * { cursor: ${t} !important; }`,document.head.appendChild(this.dragCursorStyle);else try{document.head.removeChild(this.dragCursorStyle)}catch{}}resizeMode=t=>{if(t){if(this.hasResized=!1,this.formattedWidth="",this.target){this.useRelativeSize=this.formatter.useRelative(this.target),this.editorStyle=getComputedStyle(this.formatter.quill.root),this.editorWidth=this.formatter.quill.root.clientWidth-parseFloat(this.editorStyle.paddingLeft)-parseFloat(this.editorStyle.paddingRight);const t=this.target.getBoundingClientRect();if(void 0!==t.height&&0!==t.height||(t.height=this.target.clientHeight+1),this.preDragWidth=t.width,this.computedAspectRatio=getComputedStyle(this.target).aspectRatio||"auto",this.calculatedAspectRatio=t.width/t.height,this.useRelativeSize)this.isUnclickable&&"auto"===this.computedAspectRatio&&(this.target.style.aspectRatio=this.formatter.options.video.defaultAspectRatio,console.warn(`No iframe aspect-ratio set. Set an aspect ratio either via custom blot or css.\nUsing temporary aspect ratio "${this.formatter.options.video.defaultAspectRatio}"`));else if(this.isUnclickable&&"auto"!==this.computedAspectRatio){const t=this.computedAspectRatio.match(/(\d+)\s*\/\s*(\d+)/);if(t)try{this.calculatedAspectRatio=parseFloat(t[1])/parseFloat(t[2])}catch{}}this.isImage&&!this.useRelativeSize&&!this.isSVG&&this.formatter.options.resize.imageOversizeProtection&&(this.naturalWidth=this.target.naturalWidth),this.showSizeInfo(!0,t.width,t.height)}}else{if(this.target&&this.hasResized){let t=this.roundDimension(this.formattedWidth);this.target.setAttribute("width",t),this.formatter.toolbar.buttons.resizeMode&&(this.formatter.toolbar.buttons.resizeMode.selected=this.isRelative),this.isUnclickable?(this.target.style.setProperty("--resize-width",`${t}`),this.target.dataset.relativeSize=`${this.isRelative}`):this.isAligned&&this.target.parentElement&&(this.target.parentElement.style.setProperty("--resize-width",`${t}`),this.target.parentElement.dataset.relativeSize=`${this.isRelative}`)}this.naturalWidth=void 0,this.formatter.update(),this.showSizeInfo(!1)}};onHandlePointerDown=t=>{this.resizeMode(!0),t.target instanceof HTMLElement&&this.target&&(this.dragHandle=t.target,this.setCursor(this.dragHandle.style.cursor),this.dragStartX=t.clientX,document.addEventListener("pointermove",this.onHandleDrag),document.addEventListener("pointerup",this.onHandlePointerUp))};onHandleDrag=t=>{if(this.target){this.hasResized=!0;const e=t.clientX-this.dragStartX;let i=0;i=this.dragHandle===this.topLeftHandle||this.dragHandle===this.bottomLeftHandle?Math.round(this.preDragWidth-e):Math.round(this.preDragWidth+e),i=Math.max(Math.min(i,this.editorWidth),this.formatter.options.resize.minimumWidthPx),this.resizeTarget(i)}};onHandlePointerUp=()=>{this.setCursor(""),this.resizeMode(!1),document.removeEventListener("pointermove",this.onHandleDrag),document.removeEventListener("pointerup",this.onHandlePointerUp)};onOverlayTouchStart=t=>{t.target===this.formatter.overlay&&(this.resizeMode(!0),this.target&&2===t.touches.length&&(t.preventDefault(),this.pinchStartDistance=this.calculateDistance(t.touches[0],t.touches[1]),this.preDragWidth=this.target.clientWidth))};onOverlayTouchMove=t=>{if(t.target===this.formatter.overlay&&this.target&&2===t.touches.length&&null!==this.pinchStartDistance&&null!==this.preDragWidth&&(t.preventDefault(),this.target)){this.hasResized=!0;const e=this.calculateDistance(t.touches[0],t.touches[1])/this.pinchStartDistance;let i=Math.round(this.preDragWidth*e);i=Math.max(Math.min(i,this.editorWidth),10),this.resizeTarget(i)}};onOverlayTouchEnd=t=>{t.target===this.formatter.overlay&&this.resizeMode(!1)};onOverlayMouseDown=t=>{t.target===this.formatter.overlay&&this.resizeMode(!0)};onOverlayMouseUp=t=>{t.target===this.formatter.overlay&&this.resizeMode(!1)};resizeTarget(t){if(this.target){const e=(t=Math.min(this.naturalWidth??1/0,t))/this.calculatedAspectRatio;this.updateSizeInfo(t,e),this.formatter.useRelative(this.target)?this.formattedWidth=100*t/this.editorWidth+"%":this.formattedWidth=`${t}px`,this.target.setAttribute("width",this.formattedWidth),this.target.setAttribute("height","auto"),this.isUnclickable?(this.useRelativeSize||"auto"!==this.computedAspectRatio||this.target.setAttribute("height",(t/this.calculatedAspectRatio|0)+"px"),this.target.style.setProperty("--resize-width",this.formattedWidth)):!this.isUnclickable&&this.isAligned&&this.target.parentElement&&this.target.parentElement.style.setProperty("--resize-width",this.formattedWidth),this.formatter.update()}}showSizeInfo(t,e=null,i=null){t?(this.cancelSizeInfoTimer(),null!==e&&null!==i&&this.updateSizeInfo(e,i),this.formatter.sizeInfo.style.transition="",this.formatter.sizeInfo.style.opacity="1"):this.closeSizeInfo()}updateSizeInfo(t,e){let i=`${t=Math.round(t)} x ${e=Math.round(e)}px`;if(this.isRelative)i=`${Math.round(100*t/this.editorWidth)}% (${i})`;else if(!this.hasResized){const s=this.target?.getAttribute("width");if(s){if(parseFloat(s)!==t){const o=t/e;i=`${s} x ${Math.round(parseFloat(s)/o)}px (${i})`}}else this.target instanceof HTMLImageElement&&this.target.naturalWidth!==t&&(i=`${this.target.naturalWidth} x ${this.target.naturalHeight}px (${i})`)}this.formatter.sizeInfo.innerText=i}get isRelative(){return this.target?.getAttribute("width")?.endsWith("%")||!1}get isAligned(){return!!this.target&&this.target.hasAttribute("data-blot-align")}createResizeModeButton(){const t=new r.default("resizeMode",this.onResizeModeClickHandler,this.formatter.options.toolbar);return t.preselect=()=>this.isRelative,t}onResizeModeClickHandler=t=>{t.stopImmediatePropagation(),this.swapResizeMode(!0)};swapResizeMode(t=!1){if(this.target){const e=this.target.getBoundingClientRect();let i;this.editorStyle=getComputedStyle(this.formatter.quill.root),this.editorWidth=this.formatter.quill.root.clientWidth-parseFloat(this.editorStyle.paddingLeft)-parseFloat(this.editorStyle.paddingRight),i=this.isRelative?`${Math.round(e.width)}px`:`${Math.round(100*e.width/this.editorWidth)}%`,this.target.setAttribute("width",`${i}`),this.target.setAttribute("height","auto"),this.formatter.currentSpec?.isUnclickable?(this.target.style.setProperty("--resize-width",`${i}`),this.target.dataset.relativeSize=`${this.isRelative}`):this.isAligned&&this.target.parentElement&&(this.target.parentElement.style.setProperty("--resize-width",`${i}`),this.target.parentElement.dataset.relativeSize=`${this.isRelative}`),this.formatter.toolbar.buttons.resizeMode.selected=this.isRelative,this.formatter.update(),t&&(this.showSizeInfo(!0,e.width,e.height),this.showSizeInfo(!1))}}closeSizeInfo(){this.sizeInfoTimerId=setTimeout((()=>{this.formatter.sizeInfo.style.transition="opacity 1s",this.formatter.sizeInfo.style.opacity="0"}),1e3)}cancelSizeInfoTimer(){null!==this.sizeInfoTimerId&&(clearTimeout(this.sizeInfoTimerId),this.sizeInfoTimerId=null)}calculateDistance(t,e){const i=e.clientX-t.clientX,s=e.clientY-t.clientY;return Math.sqrt(i*i+s*s)}roundDimension(t){return t.replace(/([^0-9.-]*)(-?[\d.]+)(.*)/,((t,e,i,s)=>`${e}${Math.round(Number(i))}${s}`))}isSvgImage(){return this.target instanceof HTMLImageElement&&(this.target.src.startsWith("data:image/")?this.target.src.includes("image/svg+xml"):this.target.src.endsWith(".svg"))}}e.default=n},737:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(572)),r=s(i(185)),n=s(i(715));class a extends o.default{aligner;alignButtons={};constructor(t){super(t),this.aligner=new r.default(t)}createAlignmentButtons(){for(const t of Object.values(this.aligner.alignments))this.alignButtons[t.name]=new n.default(t.name,this.onClickHandler,this.formatter.options.toolbar);const t=this.formatter.currentSpec?.getTargetBlot();if(t){const e=this.aligner.getAlignment(t);e&&this.alignButtons[e]&&(this.alignButtons[e].preselect=()=>!0)}}clearButtons(){for(const t of Object.values(this.alignButtons))t.selected=!1}onClickHandler=t=>{const e=t.target.closest(`span.${this.formatter.options.toolbar.buttonClassName}`);if(e){const t=e.dataset.action||"",i=this.formatter.currentSpec?.getTargetBlot();if(t&&i){const e=this.aligner.alignments[t];this.clearButtons(),this.aligner.isAligned(i,e)?this.aligner.clear(i):(this.aligner.setAlignment(i,t),this.alignButtons[t].selected=!0)}}this.formatter.update()};onCreate(){this.createAlignmentButtons(),this.toolbarButtons=Object.values(this.alignButtons)}onDestroy(){this.alignButtons={},this.toolbarButtons=[]}}e.default=a},87:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.ImageAlign=e.IframeAlign=e.Inline=void 0;const o=s(i(1));e.Inline=o.default.import("blots/inline");const r=o.default.import("parchment"),{ClassAttributor:n,Scope:a}=r;const l=new class extends n{constructor(){super("iframeAlign","ql-iframe-align",{scope:a.BLOCK,whitelist:["left","center","right"]})}add(t,e){if(t instanceof HTMLElement){"object"==typeof e?(super.add(t,e.align),t.dataset.blotAlign=e.align):(super.add(t,e),t.dataset.blotAlign=e);let i=t.getAttribute("width");return i?(isNaN(Number(i.trim().slice(-1)))||(i=`${i}px`),t.style.setProperty("--resize-width",i),t.dataset.relativeSize=`${i.endsWith("%")}`):(t.style.removeProperty("--resize-width"),t.dataset.relativeSize="false"),!0}return!1}remove(t){t instanceof HTMLElement&&(super.remove(t),delete t.dataset.blotAlign)}value(t){const e=super.value(t),i=t instanceof HTMLElement&&(t.style.getPropertyValue("--resize-width")||t.getAttribute("width"))||"";return{align:e,width:i,relativeSize:`${i.endsWith("%")}`}}};e.IframeAlign=l;const h=new class extends n{static tagName="SPAN";constructor(){super("imageAlign","ql-image-align",{scope:a.INLINE,whitelist:["left","center","right"]})}add(t,e){if(t instanceof HTMLSpanElement&&e){let i=t.querySelector("img");if("object"==typeof e&&e.align)super.add(t,e.align),t.setAttribute("contenteditable","false"),e.title?t.setAttribute("data-title",e.title):t.removeAttribute("data-title"),e.align&&(i.dataset.blotAlign=e.align);else{if("string"!=typeof e)return!1;super.add(t,e),i.dataset.blotAlign=e}let s=this.getImageWidth(i);return t.setAttribute("data-relative-size",`${s?.endsWith("%")}`),!0}{const i=t.querySelector("img");if(i instanceof HTMLImageElement){const s=o.default.find(i);return s&&(t.firstChild instanceof HTMLSpanElement||!i.parentElement?.matches('span[class^="ql-image-align-"]'))&&s.format("imageAlign",e),!0}return!1}}remove(t){t instanceof HTMLElement&&(super.remove(t),t.firstChild&&t.firstChild instanceof HTMLElement&&delete t.firstChild.dataset.blotAlign)}value(t){const e=t.querySelector("img"),i=e.parentElement,s=super.value(i),o=e.getAttribute("title")||"";let r=e.getAttribute("width")||"";return parseFloat(r)||(e.complete?r=this.getImageWidth(e):e.onload=t=>{r=this.getImageWidth(t.target)}),{align:s,title:o,width:r,contenteditable:"false",relativeSize:`${r.endsWith("%")}`}}getImageWidth=t=>{let e=t.getAttribute("width");return e?isNaN(Number(e.trim().slice(-1)))||(e=`${e}px`,t.setAttribute("width",e)):(e=`${t.naturalWidth}px`,t.setAttribute("width",e)),t.parentElement.style.setProperty("--resize-width",e),e}};e.ImageAlign=h,o.default.register({"formats/imageAlign":h,"attributors/class/imageAlign":h,"formats/iframeAlign":l,"attributors/class/iframeAlign":l},!0)},185:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(1)),r=i(87),n=o.default.import("parchment"),{Scope:a}=n;e.default=class{alignments={};options;formatter;constructor(t){this.formatter=t,this.options=t.options,this.options.align.alignments.forEach((t=>{this.alignments[t]={name:t,apply:e=>{this.setAlignment(e,t)}}}))}getAlignments(){return Object.keys(this.alignments).map((t=>this.alignments[t]))}clear(t){null!=t&&("IMG"===t.domNode.tagName?null!==t.parent&&"SPAN"===t.parent.domNode.tagName&&t.parent.format(r.ImageAlign.attrName,!1):"IFRAME"===t.domNode.tagName&&t.format(r.IframeAlign.attrName,!1))}isInlineBlot(t){return(t.statics?.scope&a.INLINE)===a.INLINE_BLOT}isBlockBlot(t){return(t.statics?.scope&a.BLOCK)===a.BLOCK_BLOT}hasInlineScope(t){return(t.statics.scope&a.INLINE)===a.INLINE}hasBlockScope(t){return(t.statics.scope&a.BLOCK)===a.BLOCK}isAligned(t,e){const i=this.getAlignment(t);return e?i===e.name:!!i}getAlignment(t){return t.domNode.dataset.blotAlign}setAlignment(t,e){if(null!=t){const i=this.isAligned(t,this.alignments[e]);if(this.clear(t),!i)if(this.isInlineBlot(t)||this.hasInlineScope(t)){if(!t.domNode.getAttribute("width")&&this.formatter.options.resize.useRelativeSize&&!this.formatter.options.resize.allowResizeModeChange)try{const e=getComputedStyle(this.formatter.quill.root),i=this.formatter.quill.root.clientWidth-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight);t.domNode.setAttribute("width",`${Math.min(Math.round(100*t.domNode.naturalWidth/i),100)}%`)}catch{}t.format(r.ImageAlign.attrName,{align:this.alignments[e].name,title:t.domNode.getAttribute("title")||""});try{const t=this.formatter.quill.getContents().ops;2===t.length&&"\n"===t[1].insert&&this.formatter.quill.insertText(this.formatter.quill.getLength(),"\n","user")}catch{}}else(this.isBlockBlot(t)||this.hasBlockScope(t))&&t.format(r.IframeAlign.attrName,this.alignments[e].name)}}}},627:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default=class{formatter;element;buttons={};constructor(t){this.formatter=t,this.element=document.createElement("div"),this.element.classList.add(this.formatter.options.toolbar.mainClassName),this.element.addEventListener("mousedown",(t=>{t.stopPropagation()})),this.formatter.options.toolbar.mainStyle&&Object.assign(this.element.style,this.formatter.options.toolbar.mainStyle)}create(){const t=[];this.formatter.actions.forEach((e=>{e.toolbarButtons.forEach((e=>{this.buttons[e.action]=e,t.push(e.create())}))})),this.element.append(...t),this.formatter.overlay.append(this.element)}destroy(){this.element&&this.formatter.overlay.removeChild(this.element);for(const t of Object.values(this.buttons))t.destroy();this.buttons={},this.element.innerHTML=""}}},715:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default=class{action;icon;onClick;options;element=null;initialVisibility=!0;constructor(t,e,i){this.action=t,this.icon=i.icons[t],this.onClick=e,this.options=i}create(){return this.element=document.createElement("span"),this.element.innerHTML=this.icon,this.element.className=this.options.buttonClassName,this.styleButton(),this.element.dataset.action=this.action,this.selected=this.preselect(),this.element.onclick=this.onClick,this.visible=this.initialVisibility,this.element}destroy(){this.element&&(this.element.onclick=null,this.element.remove(),this.element=null)}preselect(){return!1}get selected(){return"true"===this.element?.dataset.selected}set selected(t){this.element&&(this.element.dataset.selected=`${t}`,t?this.element.style.setProperty("filter","invert(20%)"):this.element.style.removeProperty("filter"))}get visible(){return"none"!==this.element?.style.display}set visible(t){this.element&&("boolean"==typeof t&&(t=t?"inline-block":"none"),this.element.style.display=t)}styleButton(){if(this.element&&(this.options.buttonStyle&&Object.assign(this.element.style,this.options.buttonStyle),this.options.svgStyle)){const t=this.element.children[0];t&&Object.assign(t.style,this.options.svgStyle)}}}},216:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(1)).default.import("formats/image"),r=["alt","height","width","title"];e.default=class extends o{static formats(t){return r.reduce(((e,i)=>(t.hasAttribute(i)&&(e[i]=t.getAttribute(i)),e)),{})}format(t,e){r.indexOf(t)>-1?e?this.domNode.setAttribute(t,e):this.domNode.removeAttribute(t):super.format(t,e)}}},806:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(1)).default.import("formats/video");e.default=class extends o{static aspectRatio="16 / 9 auto";static create(t){const e=super.create(t);return e.setAttribute("width","100%"),e.style.aspectRatio=this.aspectRatio,e}html(){return this.domNode.outerHTML}}},156:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.IframeVideoSpec=e.UnclickableBlotSpec=e.ImageSpec=e.BlotSpec=e.ToolbarButton=e.Toolbar=e.AttributeAction=e.ResizeAction=e.DeleteAction=e.DefaultAligner=e.AlignAction=e.Action=e.default=e.DefaultOptions=void 0;var o=i(402);Object.defineProperty(e,"DefaultOptions",{enumerable:!0,get:function(){return s(o).default}});var r=i(797);Object.defineProperty(e,"default",{enumerable:!0,get:function(){return s(r).default}});var n=i(572);Object.defineProperty(e,"Action",{enumerable:!0,get:function(){return s(n).default}});var a=i(737);Object.defineProperty(e,"AlignAction",{enumerable:!0,get:function(){return s(a).default}});var l=i(185);Object.defineProperty(e,"DefaultAligner",{enumerable:!0,get:function(){return s(l).default}});var h=i(751);Object.defineProperty(e,"DeleteAction",{enumerable:!0,get:function(){return s(h).default}});var c=i(108);Object.defineProperty(e,"ResizeAction",{enumerable:!0,get:function(){return s(c).default}});var d=i(926);Object.defineProperty(e,"AttributeAction",{enumerable:!0,get:function(){return s(d).default}});var u=i(627);Object.defineProperty(e,"Toolbar",{enumerable:!0,get:function(){return s(u).default}});var m=i(715);Object.defineProperty(e,"ToolbarButton",{enumerable:!0,get:function(){return s(m).default}});var p=i(601);Object.defineProperty(e,"BlotSpec",{enumerable:!0,get:function(){return s(p).default}});var g=i(329);Object.defineProperty(e,"ImageSpec",{enumerable:!0,get:function(){return s(g).default}});var f=i(260);Object.defineProperty(e,"UnclickableBlotSpec",{enumerable:!0,get:function(){return s(f).default}});var y=i(643);Object.defineProperty(e,"IframeVideoSpec",{enumerable:!0,get:function(){return s(y).default}})},601:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(1)),r=s(i(737)),n=s(i(108)),a=s(i(751));e.default=class{formatter;isUnclickable=!1;constructor(t){this.formatter=t}init(){}getActions(){const t=[];return this.formatter.options.align.allowAligning&&t.push(new r.default(this.formatter)),this.formatter.options.resize.allowResizing&&t.push(new n.default(this.formatter)),this.formatter.options.delete.allowKeyboardDelete&&t.push(new a.default(this.formatter)),t}getTargetElement(){return null}getTargetBlot(){const t=this.getTargetElement();return t?o.default.find(t):null}getOverlayElement(){return this.getTargetElement()}setSelection(){this.formatter.quill.setSelection(null)}onHide(){}}},643:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(260));class r extends o.default{constructor(t){super(t)}}e.default=r},329:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(601)),r=s(i(926)),n=s(i(288));class a extends o.default{img;constructor(t){super(t),this.img=null}init(){this.formatter.quill.root.addEventListener("click",this.onClick)}getActions(){const t=super.getActions();return this.formatter.options.image.allowAltTitleEdit&&t.push(new r.default(this.formatter)),this.formatter.options.image.allowCompressor&&n.default.isEligibleForCompression(this.img)&&t.push(new n.default(this.formatter)),t}getTargetElement(){return this.img}onHide(){this.img=null}onClick=t=>{const e=t.target;e instanceof HTMLImageElement&&(t.stopImmediatePropagation(),t.preventDefault(),this.img=e,this.formatter.show(this))}}e.default=a},260:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=s(i(601));class r extends o.default{selector;unclickable;proxyContainer;unclickableProxies;isUnclickable=!0;constructor(t){super(t),this.selector=t.options.video.selector,this.unclickable=null,this.proxyContainer=this.createProxyContainer(),this.unclickableProxies={}}init(){this.formatter.quill.on("text-change",this.onTextChange),this.formatter.quill.root.addEventListener("scroll",(()=>{this.repositionProxyImages()})),this.observeEditorResize()}observeEditorResize(){let t=null;new ResizeObserver((e=>{for(const i of e)t&&clearTimeout(t),t=window.setTimeout((()=>{this.repositionProxyImages()}),200)})).observe(this.formatter.quill.root)}passWheelEventThrough=t=>{this.formatter.passWheelEventThrough(t),this.repositionProxyImages()};getTargetElement(){return this.unclickable}getOverlayElement(){return this.unclickable}onTextChange=()=>{Object.entries(this.unclickableProxies).forEach((([t,{unclickable:e,proxyImage:i}])=>{try{this.formatter.quill.root.contains(e)||(i.remove(),delete this.unclickableProxies[t])}catch{}})),this.formatter.quill.root.querySelectorAll(`${this.selector}:not([data-blot-formatter-id])`).forEach((t=>{this.createUnclickableProxyImage(t)})),this.repositionProxyImages()};createUnclickableProxyImage(t){const e=Array.from(crypto.getRandomValues(new Uint8Array(5)),(t=>String.fromCharCode(97+t%26))).join("");t.dataset.blotFormatterId=e;const i=document.createElement("canvas"),s=i.getContext("2d");s&&(s.globalAlpha=0,s.fillRect(0,0,1,1));const o=document.createElement("img");o.src=i.toDataURL("image/png"),o.classList.add("blot-formatter__proxy-image"),o.dataset.blotFormatterId=e;const r={...this.formatter.options.video.proxyStyle,position:"absolute",margin:"0",userSelect:"none"};Object.assign(o.style,r),o.style.setProperty("-webkit-user-select","none"),o.style.setProperty("-moz-user-select","none"),o.style.setProperty("-ms-user-select","none"),this.proxyContainer.appendChild(o),o.addEventListener("click",this.onProxyImageClick),o.addEventListener("contextmenu",(t=>{t.stopPropagation(),t.preventDefault()})),o.addEventListener("wheel",this.formatter.passWheelEventThrough),o.addEventListener("touchstart",this.formatter.onTouchScrollStart,{passive:!1}),o.addEventListener("touchmove",this.formatter.onTouchScrollMove,{passive:!1}),this.unclickableProxies[e]={unclickable:t,proxyImage:o}}repositionProxyImages(){if(Object.keys(this.unclickableProxies).length>0){const t=this.formatter.quill.container.getBoundingClientRect(),e=this.formatter.quill.container.scrollLeft,i=this.formatter.quill.container.scrollTop;Object.entries(this.unclickableProxies).forEach((([s,{unclickable:o,proxyImage:r}])=>{try{const s=o.getBoundingClientRect();Object.assign(r.style,{left:`${s.left-t.left-1+e}px`,top:`${s.top-t.top+i}px`,width:`${s.width}px`,height:`${s.height}px`})}catch(t){const e=`Error positioning proxy image with id ${s}: `;console.error(e,`${t instanceof Error?t.message:t}`)}}))}}onProxyImageClick=t=>{const e=t.target.dataset.blotFormatterId;this.unclickable=this.unclickableProxies[`${e}`].unclickable,this.formatter.show(this)};createProxyContainer(){const t=document.createElement("div");return t.classList.add("proxy-container"),this.formatter.quill.container.appendChild(t),t}}e.default=r},1:e=>{e.exports=t}},i={};var s=function t(s){var o=i[s];if(void 0!==o)return o.exports;var r=i[s]={exports:{}};return e[s].call(r.exports,r,r.exports,t),r.exports}(156);return s})()));