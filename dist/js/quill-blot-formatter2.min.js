!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("Quill")):"function"==typeof define&&define.amd?define(["Quill"],e):"object"==typeof exports?exports.QuillBlotFormatter2=e(require("Quill")):t.QuillBlotFormatter2=e(t.Quill)}(self,t=>(()=>{"use strict";var e={1:e=>{e.exports=t},744:t=>{var e=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===i}(t)}(t)};var i="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function s(t,e){return!1!==e.clone&&e.isMergeableObject(t)?l((i=t,Array.isArray(i)?[]:{}),t,e):t;var i}function o(t,e,i){return t.concat(e).map(function(t){return s(t,i)})}function n(t){return Object.keys(t).concat(function(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return Object.propertyIsEnumerable.call(t,e)}):[]}(t))}function r(t,e){try{return e in t}catch(t){return!1}}function a(t,e,i){var o={};return i.isMergeableObject(t)&&n(t).forEach(function(e){o[e]=s(t[e],i)}),n(e).forEach(function(n){(function(t,e){return r(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))})(t,n)||(r(t,n)&&i.isMergeableObject(e[n])?o[n]=function(t,e){if(!e.customMerge)return l;var i=e.customMerge(t);return"function"==typeof i?i:l}(n,i)(t[n],e[n],i):o[n]=s(e[n],i))}),o}function l(t,i,n){(n=n||{}).arrayMerge=n.arrayMerge||o,n.isMergeableObject=n.isMergeableObject||e,n.cloneUnlessOtherwiseSpecified=s;var r=Array.isArray(i);return r===Array.isArray(t)?r?n.arrayMerge(t,i,n):a(t,i,n):s(i,n)}l.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(t,i){return l(t,i,e)},{})};var h=l;t.exports=h}},i={};function s(t){var o=i[t];if(void 0!==o)return o.exports;var n=i[t]={exports:{}};return e[t](n,n.exports,s),n.exports}s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var o={};s.r(o),s.d(o,{Action:()=>h,AlignAction:()=>v,AttributeAction:()=>L,BlotSpec:()=>w,CaretAction:()=>E,DefaultAligner:()=>b,DeleteAction:()=>k,IframeAlignFormat:()=>u,IframeVideoSpec:()=>C,ImageAlignFormat:()=>p,ImageSpec:()=>z,LinkAction:()=>A,ResizeAction:()=>x,Toolbar:()=>W,ToolbarButton:()=>y,UnclickableBlotSpec:()=>S,default:()=>P});var n=s(1),r=s.n(n),a=s(744),l=s.n(a);class h{formatter;toolbarButtons=[];constructor(t){this.formatter=t}onCreate(){}onDestroy(){}onUpdate(){}}r().import("blots/inline");const c=r().import("parchment"),{ClassAttributor:d,Scope:m}=c;const u=new class extends d{constructor(){super("iframeAlign","ql-iframe-align",{scope:m.BLOCK,whitelist:["left","center","right"]})}add(t,e){if(t instanceof HTMLElement){"object"==typeof e?(super.add(t,e.align),t.dataset.blotAlign=e.align):(super.add(t,e),t.dataset.blotAlign=e);let i=t.getAttribute("width");return i?(isNaN(Number(i.trim().slice(-1)))||(i=`${i}px`),t.style.setProperty("--resize-width",i),t.dataset.relativeSize=`${i.endsWith("%")}`):(t.style.removeProperty("--resize-width"),t.dataset.relativeSize="false"),!0}return!1}remove(t){t instanceof HTMLElement&&(super.remove(t),delete t.dataset.blotAlign)}value(t){const e=super.value(t),i=t instanceof HTMLElement&&(t.style.getPropertyValue("--resize-width")||t.getAttribute("width"))||"";return{align:e,width:i,relativeSize:`${i.endsWith("%")}`}}};const p=new class extends d{static tagName="SPAN";constructor(){super("imageAlign","ql-image-align",{scope:m.INLINE,whitelist:["left","center","right"]})}add(t,e){if(t instanceof HTMLSpanElement&&e){let i=t.querySelector("img");if("object"==typeof e&&e.align)super.add(t,e.align),t.setAttribute("contenteditable","false"),e.title?t.setAttribute("data-title",e.title):t.removeAttribute("data-title"),e.align&&(i.dataset.blotAlign=e.align);else{if("string"!=typeof e)return!1;super.add(t,e),i.dataset.blotAlign=e}let s=this.getImageWidth(i);return t.setAttribute("data-relative-size",`${s?.endsWith("%")}`),!0}{const i=t.querySelector("img");if(i instanceof HTMLImageElement){const s=r().find(i);return s&&(t.firstChild instanceof HTMLSpanElement||!i.parentElement?.matches('span[class^="ql-image-align-"]'))&&s.format("imageAlign",e),!0}return!1}}remove(t){t instanceof HTMLElement&&(super.remove(t),t.firstChild&&t.firstChild instanceof HTMLElement&&delete t.firstChild.dataset.blotAlign)}value(t){const e=t.querySelector("img");if(!e)return null;const i=e.parentElement,s=super.value(i),o=e.getAttribute("title")||"";let n=e.getAttribute("width")||"";return parseFloat(n)||(e.complete?n=this.getImageWidth(e):e.onload=t=>{n=this.getImageWidth(t.target)}),{align:s,title:o,width:n,contenteditable:"false",relativeSize:`${n.endsWith("%")}`}}getImageWidth=t=>{let e=t.getAttribute("width");return e?isNaN(Number(e.trim().slice(-1)))||(e=`${e}px`,t.setAttribute("width",e)):(e=`${t.naturalWidth}px`,t.setAttribute("width",e)),t.parentElement.style.setProperty("--resize-width",e),e}};r().register({"formats/imageAlign":p,"attributors/class/imageAlign":p,"formats/iframeAlign":u,"attributors/class/iframeAlign":u},!0);const g=r().import("parchment"),{Scope:f}=g;class b{alignments={};options;formatter;constructor(t){this.formatter=t,this.options=t.options,this.options.align.alignments.forEach(t=>{this.alignments[t]={name:t,apply:e=>{this.setAlignment(e,t)}}})}getAlignments(){return Object.keys(this.alignments).map(t=>this.alignments[t])}clear(t){null!=t&&("IMG"===t.domNode.tagName?null!==t.parent&&"SPAN"===t.parent.domNode.tagName&&t.parent.format(p.attrName,!1):"IFRAME"===t.domNode.tagName&&t.format(u.attrName,!1))}isInlineBlot(t){return(t.statics?.scope&f.INLINE)===f.INLINE_BLOT}isBlockBlot(t){return(t.statics?.scope&f.BLOCK)===f.BLOCK_BLOT}hasInlineScope(t){return(t.statics.scope&f.INLINE)===f.INLINE}hasBlockScope(t){return(t.statics.scope&f.BLOCK)===f.BLOCK}isAligned(t,e){const i=this.getAlignment(t);return e?i===e.name:!!i}getAlignment(t){return t.domNode.dataset.blotAlign}setAlignment(t,e){if(null!=t){const i=this.isAligned(t,this.alignments[e]);if(this.clear(t),!i)if(this.isInlineBlot(t)||this.hasInlineScope(t)){if(!t.domNode.getAttribute("width")&&this.options.resize.useRelativeSize&&!this.options.resize.allowResizeModeChange)try{const e=getComputedStyle(this.formatter.quill.root),i=this.formatter.quill.root.clientWidth-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight);t.domNode.setAttribute("width",`${Math.min(Math.round(100*t.domNode.naturalWidth/i),100)}%`)}catch{}t.format(p.attrName,{align:this.alignments[e].name,title:t.domNode.getAttribute("title")||""});try{const t=this.formatter.quill.getContents().ops;2===t.length&&"\n"===t[1].insert&&this.formatter.quill.insertText(this.formatter.quill.getLength(),"\n","user")}catch{}}else(this.isBlockBlot(t)||this.hasBlockScope(t))&&t.format(u.attrName,this.alignments[e].name)}}}class y{action;icon;onClick;options;element=null;initialVisibility=!0;constructor(t,e,i){this.action=t,this.icon=i.icons[t],this.onClick=e,this.options=i}create(){return this.element=document.createElement("span"),this.element.innerHTML=this.icon,this.element.className=this.options.buttonClassName,this.element.dataset.action=this.action,this.element.onclick=this.onClick,this.options.tooltips&&this.options.tooltips[this.action]&&(this.element.title=this.options.tooltips[this.action]),this.selected=this.preselect(),this.visible=this.initialVisibility,this.styleButton(),this.element}destroy(){this.element&&(this.element.onclick=null,this.element.remove(),this.element=null)}preselect(){return!1}get selected(){return"true"===this.element?.dataset.selected}set selected(t){this.element&&(this.element.dataset.selected=t.toString(),t?(this.element.classList.add(this.options.buttonSelectedClassName),this.options.buttonSelectedStyle&&Object.assign(this.element.style,this.options.buttonSelectedStyle)):(this.element.classList.remove(this.options.buttonSelectedClassName),this.options.buttonSelectedStyle&&(this.element.removeAttribute("style"),this.options.buttonStyle&&Object.assign(this.element.style,this.options.buttonStyle))))}get visible(){return"none"!==this.element?.style.display}set visible(t){this.element&&("boolean"==typeof t&&(t=t?"inline-block":"none"),this.element.style.display=t)}styleButton(){if(this.element&&(this.options.buttonStyle&&Object.assign(this.element.style,this.options.buttonStyle),this.options.svgStyle)){const t=this.element.children[0];t&&Object.assign(t.style,this.options.svgStyle)}}}class v extends h{aligner;alignButtons={};constructor(t){super(t),this.aligner=new b(t)}createAlignmentButtons(){for(const t of Object.values(this.aligner.alignments))this.alignButtons[t.name]=new y(t.name,this.onClickHandler,this.formatter.options.toolbar);const t=this.formatter.currentSpec?.getTargetBlot();if(t){const e=this.aligner.getAlignment(t);e&&this.alignButtons[e]&&(this.alignButtons[e].preselect=()=>!0)}}clearButtons(){for(const t of Object.values(this.alignButtons))t.selected=!1}onClickHandler=t=>{const e=t.target.closest(`span.${this.formatter.options.toolbar.buttonClassName}`);if(e){const t=e.dataset.action||"",i=this.formatter.currentSpec?.getTargetBlot();if(t&&i){const e=this.aligner.alignments[t];this.clearButtons(),this.aligner.isAligned(i,e)?this.aligner.clear(i):(this.aligner.setAlignment(i,t),this.alignButtons[t].selected=!0)}}this.formatter.update()};onCreate(){this.createAlignmentButtons(),this.toolbarButtons=Object.values(this.alignButtons)}onDestroy(){this.alignButtons={},this.toolbarButtons=[]}}class x extends h{topLeftHandle;topRightHandle;bottomRightHandle;bottomLeftHandle;dragHandle=null;dragStartX=0;dragCursorStyle;preDragWidth=0;pinchStartDistance=0;calculatedAspectRatio=0;computedAspectRatio=void 0;target;editorStyle;editorWidth=0;useRelativeSize;resizeModeButton=null;isUnclickable=!1;hasResized=!1;formattedWidth="";sizeInfoTimerId=null;isImage=!1;isSVG=!1;naturalWidth=void 0;constructor(t){super(t),this.topLeftHandle=this.createHandle("top-left","nwse-resize"),this.topRightHandle=this.createHandle("top-right","nesw-resize"),this.bottomRightHandle=this.createHandle("bottom-right","nwse-resize"),this.bottomLeftHandle=this.createHandle("bottom-left","nesw-resize"),this.dragCursorStyle=document.createElement("style"),this.useRelativeSize=this.formatter.options.resize.useRelativeSize,t.options.resize.allowResizeModeChange&&(this.resizeModeButton=this.createResizeModeButton(),this.toolbarButtons=[this.resizeModeButton])}onCreate(){this.target=this.formatter.currentSpec?.getTargetElement(),this.isUnclickable=this.formatter.currentSpec?.isUnclickable||!1,this.isImage=this.target instanceof HTMLImageElement,this.isImage&&(this.isSVG=this.isSvgImage()),this.formatter.overlay.appendChild(this.topLeftHandle),this.formatter.overlay.appendChild(this.topRightHandle),this.formatter.overlay.appendChild(this.bottomRightHandle),this.formatter.overlay.appendChild(this.bottomLeftHandle),this.formatter.overlay.addEventListener("mousedown",this.onOverlayMouseDown),this.formatter.overlay.addEventListener("mouseup",this.onOverlayMouseUp),this.formatter.overlay.addEventListener("touchstart",this.onOverlayTouchStart,{passive:!1}),this.formatter.overlay.addEventListener("touchmove",this.onOverlayTouchMove,{passive:!1}),this.formatter.overlay.addEventListener("touchend",this.onOverlayTouchEnd,{passive:!1});const t=this.formatter.options.resize.handleStyle||{};this.repositionHandles(t)}onDestroy(){this.target=null,this.isUnclickable=!1,this.isImage=!1,this.naturalWidth=void 0,this.isSVG=!1,this.setCursor(""),this.formatter.overlay.removeChild(this.topLeftHandle),this.formatter.overlay.removeChild(this.topRightHandle),this.formatter.overlay.removeChild(this.bottomRightHandle),this.formatter.overlay.removeChild(this.bottomLeftHandle),this.formatter.overlay.removeEventListener("mousedown",this.onOverlayMouseDown),this.formatter.overlay.removeEventListener("mouseup",this.onOverlayMouseUp),this.formatter.overlay.removeEventListener("touchstart",this.onOverlayTouchStart,{passive:!1}),this.formatter.overlay.removeEventListener("touchmove",this.onOverlayTouchMove,{passive:!1}),this.formatter.overlay.removeEventListener("touchend",this.onOverlayTouchEnd,{passive:!1}),this.formatter.update()}createHandle(t,e){const i=document.createElement("div");return i.classList.add(this.formatter.options.resize.handleClassName),i.setAttribute("data-position",t),i.style.cursor=e,this.formatter.options.resize.handleStyle&&Object.assign(i.style,this.formatter.options.resize.handleStyle),i.addEventListener("pointerdown",this.onHandlePointerDown),i}repositionHandles(t){let e="0px",i="0px";t&&(t.width&&(e=-parseFloat(t.width)/2+"px"),t.height&&(i=-parseFloat(t.height)/2+"px")),Object.assign(this.topLeftHandle.style,{left:e,top:i}),Object.assign(this.topRightHandle.style,{right:e,top:i}),Object.assign(this.bottomRightHandle.style,{right:e,bottom:i}),Object.assign(this.bottomLeftHandle.style,{left:e,bottom:i})}setCursor(t){if(document.body)if(t)this.dragCursorStyle.innerHTML=`body, body * { cursor: ${t} !important; }`,document.head.appendChild(this.dragCursorStyle);else try{document.head.removeChild(this.dragCursorStyle)}catch{}}resizeMode=t=>{if(t){if(this.hasResized=!1,this.formattedWidth="",this.target){this.useRelativeSize=this.formatter.useRelative(this.target),this.editorStyle=getComputedStyle(this.formatter.quill.root),this.editorWidth=this.formatter.quill.root.clientWidth-parseFloat(this.editorStyle.paddingLeft)-parseFloat(this.editorStyle.paddingRight);const t=this.target.getBoundingClientRect();if(void 0!==t.height&&0!==t.height||(t.height=this.target.clientHeight+1),this.preDragWidth=t.width,this.computedAspectRatio=getComputedStyle(this.target).aspectRatio||"auto",this.calculatedAspectRatio=t.width/t.height,this.useRelativeSize)this.isUnclickable&&"auto"===this.computedAspectRatio&&(this.target.style.aspectRatio=this.formatter.options.video.defaultAspectRatio,console.warn(`No iframe aspect-ratio set. Set an aspect ratio either via custom blot or css.\nUsing temporary aspect ratio "${this.formatter.options.video.defaultAspectRatio}"`));else if(this.isUnclickable&&"auto"!==this.computedAspectRatio){const t=this.computedAspectRatio.match(/(\d+)\s*\/\s*(\d+)/);if(t)try{this.calculatedAspectRatio=parseFloat(t[1])/parseFloat(t[2])}catch{}}this.isImage&&!this.useRelativeSize&&!this.isSVG&&this.formatter.options.resize.imageOversizeProtection&&(this.naturalWidth=this.target.naturalWidth),this.showSizeInfo(!0,t.width,t.height)}}else{if(this.target&&this.hasResized){let t=this.roundDimension(this.formattedWidth);this.target.setAttribute("width",t),this.formatter.toolbar.buttons.resizeMode&&(this.formatter.toolbar.buttons.resizeMode.selected=this.isRelative),this.isUnclickable?(this.target.style.setProperty("--resize-width",`${t}`),this.target.dataset.relativeSize=`${this.isRelative}`):this.isAligned&&this.target.parentElement&&(this.target.parentElement.style.setProperty("--resize-width",`${t}`),this.target.parentElement.dataset.relativeSize=`${this.isRelative}`)}this.naturalWidth=void 0,this.formatter.update(),this.showSizeInfo(!1)}};onHandlePointerDown=t=>{this.resizeMode(!0),t.target instanceof HTMLElement&&this.target&&(this.dragHandle=t.target,this.setCursor(this.dragHandle.style.cursor),this.dragStartX=t.clientX,document.addEventListener("pointermove",this.onHandleDrag),document.addEventListener("pointerup",this.onHandlePointerUp))};onHandleDrag=t=>{if(this.target){this.hasResized=!0;const e=t.clientX-this.dragStartX;let i=0;i=this.dragHandle===this.topLeftHandle||this.dragHandle===this.bottomLeftHandle?Math.round(this.preDragWidth-e):Math.round(this.preDragWidth+e),i=Math.max(Math.min(i,this.editorWidth),this.formatter.options.resize.minimumWidthPx),this.resizeTarget(i)}};onHandlePointerUp=()=>{this.setCursor(""),this.resizeMode(!1),document.removeEventListener("pointermove",this.onHandleDrag),document.removeEventListener("pointerup",this.onHandlePointerUp)};onOverlayTouchStart=t=>{t.target===this.formatter.overlay&&(this.resizeMode(!0),this.target&&2===t.touches.length&&(t.preventDefault(),this.pinchStartDistance=this.calculateDistance(t.touches[0],t.touches[1]),this.preDragWidth=this.target.clientWidth))};onOverlayTouchMove=t=>{if(t.target===this.formatter.overlay&&this.target&&2===t.touches.length&&null!==this.pinchStartDistance&&null!==this.preDragWidth&&(t.preventDefault(),this.target)){this.hasResized=!0;const e=this.calculateDistance(t.touches[0],t.touches[1])/this.pinchStartDistance;let i=Math.round(this.preDragWidth*e);i=Math.max(Math.min(i,this.editorWidth),10),this.resizeTarget(i)}};onOverlayTouchEnd=t=>{t.target===this.formatter.overlay&&this.resizeMode(!1)};onOverlayMouseDown=t=>{t.target===this.formatter.overlay&&this.resizeMode(!0)};onOverlayMouseUp=t=>{t.target===this.formatter.overlay&&this.resizeMode(!1)};resizeTarget(t){if(this.target){const e=(t=Math.min(this.naturalWidth??1/0,t))/this.calculatedAspectRatio;this.updateSizeInfo(t,e),this.formatter.useRelative(this.target)?this.formattedWidth=100*t/this.editorWidth+"%":this.formattedWidth=`${t}px`,this.target.setAttribute("width",this.formattedWidth),this.target.setAttribute("height","auto"),this.isUnclickable?(this.useRelativeSize||"auto"!==this.computedAspectRatio||this.target.setAttribute("height",(t/this.calculatedAspectRatio|0)+"px"),this.target.style.setProperty("--resize-width",this.formattedWidth)):!this.isUnclickable&&this.isAligned&&this.target.parentElement&&this.target.parentElement.style.setProperty("--resize-width",this.formattedWidth),this.formatter.update()}}showSizeInfo(t,e=null,i=null){t?(this.cancelSizeInfoTimer(),null!==e&&null!==i&&this.updateSizeInfo(e,i),this.formatter.sizeInfo.style.transition="",this.formatter.sizeInfo.style.opacity="1"):this.closeSizeInfo()}updateSizeInfo(t,e){let i=`${t=Math.round(t)} x ${e=Math.round(e)}px`;if(this.isRelative)i=`${Math.round(100*t/this.editorWidth)}% (${i})`;else if(!this.hasResized){const s=this.target?.getAttribute("width");if(s){if(parseFloat(s)!==t){const o=t/e;i=`${s} x ${Math.round(parseFloat(s)/o)}px (${i})`}}else this.target instanceof HTMLImageElement&&this.target.naturalWidth!==t&&(i=`${this.target.naturalWidth} x ${this.target.naturalHeight}px (${i})`)}this.formatter.sizeInfo.innerText=i}get isRelative(){return this.target?.getAttribute("width")?.endsWith("%")||!1}get isAligned(){return!!this.target&&this.target.hasAttribute("data-blot-align")}createResizeModeButton(){const t=new y("resizeMode",this.onResizeModeClickHandler,this.formatter.options.toolbar);return t.preselect=()=>this.isRelative,t}onResizeModeClickHandler=t=>{t.stopImmediatePropagation(),this.swapResizeMode(!0)};swapResizeMode(t=!1){if(this.target){const e=this.target.getBoundingClientRect();let i;this.editorStyle=getComputedStyle(this.formatter.quill.root),this.editorWidth=this.formatter.quill.root.clientWidth-parseFloat(this.editorStyle.paddingLeft)-parseFloat(this.editorStyle.paddingRight),i=this.isRelative?`${Math.round(e.width)}px`:`${Math.round(100*e.width/this.editorWidth)}%`,this.target.setAttribute("width",`${i}`),this.target.setAttribute("height","auto"),this.formatter.currentSpec?.isUnclickable?(this.target.style.setProperty("--resize-width",`${i}`),this.target.dataset.relativeSize=`${this.isRelative}`):this.isAligned&&this.target.parentElement&&(this.target.parentElement.style.setProperty("--resize-width",`${i}`),this.target.parentElement.dataset.relativeSize=`${this.isRelative}`),this.formatter.toolbar.buttons.resizeMode.selected=this.isRelative,this.formatter.update(),t&&(this.showSizeInfo(!0,e.width,e.height),this.showSizeInfo(!1))}}closeSizeInfo(){this.sizeInfoTimerId=setTimeout(()=>{this.formatter.sizeInfo.style.transition="opacity 1s",this.formatter.sizeInfo.style.opacity="0"},1e3)}cancelSizeInfoTimer(){null!==this.sizeInfoTimerId&&(clearTimeout(this.sizeInfoTimerId),this.sizeInfoTimerId=null)}calculateDistance(t,e){const i=e.clientX-t.clientX,s=e.clientY-t.clientY;return Math.sqrt(i*i+s*s)}roundDimension(t){return t.replace(/([^0-9.-]*)(-?[\d.]+)(.*)/,(t,e,i,s)=>`${e}${Math.round(Number(i))}${s}`)}isSvgImage(){return this.target instanceof HTMLImageElement&&(this.target.src.startsWith("data:image/")?this.target.src.includes("image/svg+xml"):this.target.src.endsWith(".svg"))}}class k extends h{onCreate(){document.addEventListener("keyup",this.onKeyUp),this.formatter.quill.root.addEventListener("input",this.onKeyUp)}onDestroy(){document.removeEventListener("keyup",this.onKeyUp),this.formatter.quill.root.removeEventListener("input",this.onKeyUp)}onKeyUp=t=>{const e=!!document.querySelector("[data-blot-formatter-modal]");if(this.formatter.currentSpec&&!e&&("Delete"===t.code||"Backspace"===t.code)){const t=this.formatter.currentSpec.getTargetElement();if(t){const e=r().find(t);if(e){const t=this.formatter.quill.getIndex(e);this.formatter.quill.deleteText(t,1,"user")}}this.formatter.hide()}}}class E extends h{static sendCaretBack(t=1){const e=window.getSelection();if(e&&e.rangeCount>0){const i=e.getRangeAt(0),s=i.startContainer,o=i.startOffset;if(o>0)i.setStart(s,o-t);else if(s.previousSibling){const t=s.previousSibling;t.nodeType===Node.TEXT_NODE&&i.setStart(t,t.textContent?.length||0)}i.collapse(!0),e.removeAllRanges(),e.addRange(i)}}static placeCaretBeforeBlot(t,e){const i=t.getIndex(e);t.setSelection(i,0,"user")}static placeCaretAfterBlot(t,e){t.setSelection(null),t.root.focus();const i=t.getIndex(e),s=t.getLength();i+1>=s-1?t.setSelection(s-1,0,"user"):(t.setSelection(i+2,0,"user"),this.sendCaretBack(1))}onCreate=()=>{document.addEventListener("keyup",this.onKeyUp),this.formatter.quill.root.addEventListener("input",this.onKeyUp)};onDestroy=()=>{document.removeEventListener("keyup",this.onKeyUp),this.formatter.quill.root.removeEventListener("input",this.onKeyUp)};onKeyUp=t=>{const e=!!document.querySelector("[data-blot-formatter-modal]");if(!this.formatter.currentSpec||e)return;const i=this.formatter.currentSpec.getTargetBlot();i&&("ArrowLeft"===t.code?(E.placeCaretBeforeBlot(this.formatter.quill,i),this.formatter.hide()):"ArrowRight"===t.code&&(E.placeCaretAfterBlot(this.formatter.quill,i),this.formatter.hide()))}}class w{formatter;isUnclickable=!1;constructor(t){this.formatter=t}init(){}getActions(){const t=[];return this.formatter.options.align.allowAligning&&t.push(new v(this.formatter)),this.formatter.options.resize.allowResizing&&t.push(new x(this.formatter)),this.formatter.options.delete.allowKeyboardDelete&&t.push(new k(this.formatter)),t.push(new E(this.formatter)),t}getTargetElement(){return null}getTargetBlot(){const t=this.getTargetElement();return t?r().find(t):null}getOverlayElement(){return this.getTargetElement()}setSelection(){this.formatter.quill.setSelection(null)}onHide(){}}class S extends w{selector;unclickable;proxyContainer;unclickableProxies;isUnclickable=!0;constructor(t){super(t),this.selector=t.options.video.selector,this.unclickable=null,this.proxyContainer=this.createProxyContainer(),this.unclickableProxies={}}init(){this.formatter.quill.on("text-change",this.onTextChange),this.formatter.quill.root.addEventListener("scroll",()=>{this.repositionProxyImages()}),this.observeEditorResize()}observeEditorResize(){let t=null;new ResizeObserver(e=>{for(const i of e)t&&clearTimeout(t),t=window.setTimeout(()=>{this.repositionProxyImages()},200)}).observe(this.formatter.quill.root)}passWheelEventThrough=t=>{this.formatter.passWheelEventThrough(t),this.repositionProxyImages()};getTargetElement(){return this.unclickable}getOverlayElement(){return this.unclickable}onTextChange=()=>{Object.entries(this.unclickableProxies).forEach(([t,{unclickable:e,proxyImage:i}])=>{try{this.formatter.quill.root.contains(e)||(i.remove(),delete this.unclickableProxies[t])}catch{}}),this.formatter.quill.root.querySelectorAll(`${this.selector}:not([data-blot-formatter-id])`).forEach(t=>{this.createUnclickableProxyImage(t)}),this.repositionProxyImages()};createUnclickableProxyImage(t){const e=Array.from(crypto.getRandomValues(new Uint8Array(5)),t=>String.fromCharCode(97+t%26)).join("");t.dataset.blotFormatterId=e;const i=document.createElement("canvas"),s=i.getContext("2d");s&&(s.globalAlpha=0,s.fillRect(0,0,1,1));const o=document.createElement("img");o.src=i.toDataURL("image/png"),o.classList.add("blot-formatter__proxy-image"),o.dataset.blotFormatterId=e;const n={...this.formatter.options.video.proxyStyle,position:"absolute",margin:"0",userSelect:"none"};Object.assign(o.style,n),o.style.setProperty("-webkit-user-select","none"),o.style.setProperty("-moz-user-select","none"),o.style.setProperty("-ms-user-select","none"),this.proxyContainer.appendChild(o),o.addEventListener("click",this.onProxyImageClick),o.addEventListener("contextmenu",t=>{t.stopPropagation(),t.preventDefault()}),o.addEventListener("wheel",this.formatter.passWheelEventThrough),o.addEventListener("touchstart",this.formatter.onTouchScrollStart,{passive:!1}),o.addEventListener("touchmove",this.formatter.onTouchScrollMove,{passive:!1}),this.unclickableProxies[e]={unclickable:t,proxyImage:o}}repositionProxyImages(){if(Object.keys(this.unclickableProxies).length>0){const t=this.formatter.quill.container.getBoundingClientRect(),e=this.formatter.quill.container.scrollLeft,i=this.formatter.quill.container.scrollTop;Object.entries(this.unclickableProxies).forEach(([s,{unclickable:o,proxyImage:n}])=>{try{const s=o.getBoundingClientRect();Object.assign(n.style,{left:`${s.left-t.left-1+e}px`,top:`${s.top-t.top+i}px`,width:`${s.width}px`,height:`${s.height}px`})}catch(t){const e=`Error positioning proxy image with id ${s}: `;console.error(e,`${t instanceof Error?t.message:t}`)}})}}onProxyImageClick=t=>{const e=t.target.dataset.blotFormatterId;this.unclickable=this.unclickableProxies[`${e}`].unclickable,this.formatter.show(this)};createProxyContainer(){const t=document.createElement("div");return t.classList.add("proxy-container"),this.formatter.quill.container.appendChild(t),t}}class C extends S{constructor(t){super(t)}}class L extends h{modal;targetElement=null;constructor(t){super(t),this.toolbarButtons=[new y("attribute",this.onClickHandler,this.formatter.options.toolbar)],this.modal=this.createModal()}onCreate(){this.targetElement=this.formatter.currentSpec?.getTargetElement()}onDestroy(){this.targetElement=null,this.modal.element.remove()}onClickHandler=()=>{this.showAltTitleModal()};showAltTitleModal(){this.targetElement&&(this.modal.altInput.value=this.targetElement.getAttribute("alt")||"",this.modal.titleInput.value=this.targetElement.getAttribute("title")||"",document.body.append(this.modal.element))}hideAltTitleModal(){this.modal.element.remove()}setAltTitle(){if(this.targetElement){const t="string"==typeof this.modal.altInput.value?this.modal.altInput.value:"",e=this.modal.titleInput.value;this.targetElement.setAttribute("alt",t),e?this.targetElement.setAttribute("title",e):this.targetElement.removeAttribute("title");const i=r().find(this.targetElement),s=i?.parent?.formats()[p.attrName]?.align;i&&s&&(i.parent?.format(p.attrName,!1),i.format(p.attrName,{align:s,title:e}))}}createModal(){const t=Array.from(crypto.getRandomValues(new Uint8Array(5)),t=>String.fromCharCode(97+t%26)).join(""),e=document.createElement("div");e.id=`${t}-modal`,e.setAttribute("data-blot-formatter-modal","");const i=document.createElement("div"),s=document.createElement("form");s.id=`${t}-form`;const o=document.createElement("label");o.setAttribute("for","alt"),o.textContent=this.formatter.options.overlay.labels?.alt||this.formatter.options.image.altTitleModalOptions.labels.alt;const n=document.createElement("textarea");n.name="alt",n.rows=3;const r=document.createElement("label");r.setAttribute("for","title"),r.textContent=this.formatter.options.overlay.labels?.title||this.formatter.options.image.altTitleModalOptions.labels.title;const a=document.createElement("textarea");a.name="title",a.rows=3;const l=document.createElement("div"),h=document.createElement("button");h.type="submit",h.innerHTML=this.formatter.options.image.altTitleModalOptions.icons.submitButton,l.appendChild(h),s.appendChild(o),s.appendChild(n),s.appendChild(r),s.appendChild(a),s.appendChild(l);const c=document.createElement("button");return c.id=`${t}-cancel`,c.type="button",c.innerHTML=this.formatter.options.image.altTitleModalOptions.icons.cancelButton,this.formatter.options.image.altTitleModalOptions.styles&&(Object.assign(e.style,this.formatter.options.image.altTitleModalOptions.styles.modalBackground),Object.assign(i.style,this.formatter.options.image.altTitleModalOptions.styles.modalContainer),Object.assign(o.style,this.formatter.options.image.altTitleModalOptions.styles.label),Object.assign(n.style,this.formatter.options.image.altTitleModalOptions.styles.textarea),Object.assign(r.style,this.formatter.options.image.altTitleModalOptions.styles.label),Object.assign(a.style,this.formatter.options.image.altTitleModalOptions.styles.textarea),Object.assign(h.style,this.formatter.options.image.altTitleModalOptions.styles.submitButton),Object.assign(c.style,this.formatter.options.image.altTitleModalOptions.styles.cancelButton)),i.appendChild(s),i.appendChild(c),e.appendChild(i),s.addEventListener("submit",t=>{t.preventDefault(),this.setAltTitle(),this.hideAltTitleModal()}),s.addEventListener("cancel",()=>{this.hideAltTitleModal()}),e.addEventListener("pointerdown",t=>{t.target===e&&this.hideAltTitleModal()}),c.addEventListener("click",()=>{this.hideAltTitleModal()}),{element:e,form:s,altInput:n,titleInput:a,cancelButton:c}}}class M extends h{options;modal;targetElement=null;imageDetails=null;constructor(t){super(t),this.options=this.formatter.options.image.compressorOptions,this.toolbarButtons=[new y("compress",this.onClickHandler,this.formatter.options.toolbar)],this.modal=this.createModal()}onCreate(){this.targetElement=this.formatter.currentSpec?.getTargetElement(),this.toolbarButtons[0].initialVisibility=M.isEligibleForCompression(this.targetElement)}onDestroy(){this.targetElement=null,this.hideModal()}onClickHandler=()=>{this.showModal()};showModal(){this.targetElement instanceof HTMLImageElement&&(this.imageDetails=this.getImageDetails(this.targetElement),this.imageDetails.canCompress?(this.modal.moreInfoButton.style.visibility="visible",this.modal.moreInfoText.style.display="none",document.body.append(this.modal.element)):this.displayFeedback(this.options.text.nothingToDo))}hideModal(){this.modal.element.remove()}static isEligibleForCompression(t){if(t instanceof HTMLImageElement&&t.src.startsWith("data:image/")){const e=t.src.substring(5,t.src.indexOf(";"));return"svg+xml"!==e&&"gif"!==e}return!1}parseDimensions(t){let e=t.getAttribute("width"),i=t.getAttribute("height"),s=null,o=null;if(e)if(e.toLowerCase().endsWith("px"))s=parseFloat(e);else if(e.endsWith("%"))s=this.options.maxWidth??null;else if(e.toLowerCase().endsWith("em")||e.toLowerCase().endsWith("rem"))s=16*parseFloat(e);else{if(isNaN(parseFloat(e)))return[null,null];s=parseFloat(e)}if(i)if(isNaN(parseFloat(i)))if(i.toLowerCase().endsWith("px"))o=parseFloat(i);else if(i.toLowerCase().endsWith("em")||i.toLowerCase().endsWith("rem"))o=16*parseFloat(i);else{if(!(s&&t.naturalWidth>0&&t.naturalHeight>0))return[null,null];o=s/(t.naturalWidth/t.naturalHeight)}else o=parseFloat(i);return[s,o]}getImageSize(t){const e=t.getAttribute("src");if(!e||!e.startsWith("data:image/"))return null;const i=e.split(",")[1];return i?Math.ceil(3*i.length/4):null}displayFeedback(t){this.formatter.sizeInfo.innerHTML=t,this.formatter.sizeInfo.style.transition="",this.formatter.sizeInfo.style.opacity="1",setTimeout(()=>{this.formatter.sizeInfo.style.transition="opacity 1s",this.formatter.sizeInfo.style.opacity="0"},2500)}getImageDetails(t){let[e,i]=this.parseDimensions(t);return!e&&(this.options.maxWidth??1/0)<t.naturalWidth&&(e=this.options.maxWidth,i=e/(t.naturalWidth/t.naturalHeight)),{naturalWidth:t.naturalWidth,naturalHeight:t.naturalHeight,targetWidth:e,targetHeight:i,size:this.getImageSize(t),canCompress:!!(e&&i&&e<t.naturalWidth&&M.isEligibleForCompression(t))}}compressImage=t=>{if(this.imageDetails&&this.imageDetails.canCompress){const e=new Image;e.src=t.src,e.onload=()=>{const i=document.createElement("canvas");i.width=this.imageDetails.targetWidth,i.height=this.imageDetails.targetHeight;i.getContext("2d").drawImage(e,0,0,i.width,i.height);const s=i.toDataURL("image/jpeg",this.options.jpegQuality),o=(new TextEncoder).encode(t.src).length;(new TextEncoder).encode(s).length<o&&(t.src=s);const n=`${Math.ceil((this.imageDetails.size-this.getImageSize(t))/1024)}kB`,r=`${this.options.text.reducedLabel}: ${n}<br>\n                            ${this.imageDetails.naturalWidth} x ${this.imageDetails.naturalHeight}px → ${i.width} x ${Math.round(i.height)}px\n                        `;return this.displayFeedback(r),!0},e.onerror=t=>(console.error("Image loading failed:",t),this.displayFeedback(`Image loading failed: ${t}`),!1)}else this.displayFeedback(this.options.text.nothingToDo);return!0};createModal(){const t=document.createElement("div");t.setAttribute("data-blot-formatter-compress-modal","");const e=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div"),o=document.createElement("div"),n=document.createElement("button"),r=document.createElement("button"),a=document.createElement("button");return s.style.display="none",o.append(n,r,a),e.append(i,s,o),t.appendChild(e),i.innerHTML=this.options.text.prompt,s.innerHTML=this.options.text.moreInfo||"",this.options.styles&&(Object.assign(t.style,this.options.styles.modalBackground),Object.assign(e.style,this.options.styles.modalContainer),Object.assign(o.style,this.options.styles.buttonContainer),Object.assign(n.style,{...this.options.styles.buttons,...this.options.buttons.cancel.style}),this.options.text.moreInfo?Object.assign(r.style,{...this.options.styles.buttons,...this.options.buttons.moreInfo.style}):r.style.visibility="hidden",Object.assign(a.style,{...this.options.styles.buttons,...this.options.buttons.continue.style})),n.innerHTML=this.options.icons.cancel,r.innerHTML=this.options.icons.moreInfo,a.innerHTML=this.options.icons.continue,a.addEventListener("click",t=>{this.targetElement instanceof HTMLImageElement&&this.compressImage(this.targetElement),this.hideModal()}),r.addEventListener("click",t=>{s.innerHTML=this.options.text.moreInfo||"",s.style.display="block",r.style.visibility="hidden"}),n.addEventListener("click",()=>{this.hideModal()}),t.addEventListener("pointerdown",e=>{e.stopImmediatePropagation(),e.target===t&&this.hideModal()}),{element:t,moreInfoButton:r,moreInfoText:s}}}class A extends h{targetElement=null;toolbarButton;currentBlot;linkOptions;modal;constructor(t){super(t),this.currentBlot=this.formatter.currentSpec?.getTargetBlot(),this.linkOptions=this.formatter.options.image.linkOptions,this.toolbarButton=new y("link",this._onClickHandler,this.formatter.options.toolbar),this.toolbarButton.preselect=()=>!!this.getLink(),this.toolbarButtons=[this.toolbarButton]}onCreate(){this.targetElement=this.formatter.currentSpec?.getTargetElement()}onDestroy(){this.targetElement=null,this._removeEventListeners(),this.hideLinkModal()}_addEventListeners=()=>{this.modal&&(this.modal.dialog.addEventListener("keyup",this._blockKeyEvent),this.modal.form.addEventListener("submit",this._formSubmitHandler),this.modal.input.addEventListener("input",this._blockKeyEvent),this.modal.cancelButton.addEventListener("click",this.hideLinkModal),this.modal.removeButton.addEventListener("click",this.removeLink),this.modal.background.addEventListener("click",this._onBackgroundClick),this.modal.input.addEventListener("contextmenu",this._trapContextEvent))};_removeEventListeners=()=>{this.modal&&(this.modal.dialog.removeEventListener("keyup",this._blockKeyEvent),this.modal.form.removeEventListener("submit",this._formSubmitHandler),this.modal.input.removeEventListener("input",this._blockKeyEvent),this.modal.cancelButton.removeEventListener("click",this.hideLinkModal),this.modal.removeButton.removeEventListener("click",this.removeLink),this.modal.background.removeEventListener("click",this._onBackgroundClick),this.modal.input.removeEventListener("contextmenu",this._trapContextEvent))};_blockKeyEvent=t=>{t.stopImmediatePropagation(),t.preventDefault()};_trapContextEvent=t=>{t.stopImmediatePropagation()};_onClickHandler=()=>{this.showLinkModal()};_onBackgroundClick=t=>{t.target===this.modal?.background&&(t.stopImmediatePropagation(),t.preventDefault(),this.hideLinkModal())};showLinkModal=()=>{if(this.targetElement){if(this.modal=this._buildModal(),!this.modal)return;this.formatter.overlay.append(this.modal.dialog,this.modal.background),this._addEventListeners(),this.modal.dialog.style.visibility="hidden",this.modal.dialog.show(),this._positionModal(this.modal.dialog),this.modal.dialog.style.visibility="visible",this.modal.input.focus(),this.modal.input.select()}};_buildModal=()=>{const t=document.createElement("dialog");t.className=this.linkOptions.modal.dialog.className,t.dataset.blotFormatterModal="",Object.assign(t.style,this.linkOptions.modal.dialog.style);const e=document.createElement("form");e.method="dialog",e.className=this.linkOptions.modal.form.className,Object.assign(e.style,this.linkOptions.modal.form.style);const i=document.createElement("label");i.htmlFor="link-url",i.textContent=this.linkOptions.modal.label.text,i.className=this.linkOptions.modal.label.className,Object.assign(i.style,this.linkOptions.modal.label.style);const s=document.createElement("input");s.type="url",s.id="link-url",s.name="url",s.value=this.getLink()||"",s.select(),s.autofocus=!0,s.className=this.linkOptions.modal.input.className,Object.assign(s.style,this.linkOptions.modal.input.style),s.placeholder=this.linkOptions.modal.input.placeholder||"";const o=document.createElement("button");o.type="submit",o.innerHTML=this.linkOptions.modal.buttons.submit.icon,o.className=this.linkOptions.modal.buttons.submit.className,Object.assign(o.style,this.linkOptions.modal.buttons.submit.style);const n=document.createElement("button");n.type="button",n.innerHTML=this.linkOptions.modal.buttons.cancel.icon,n.className=this.linkOptions.modal.buttons.cancel.className,Object.assign(n.style,this.linkOptions.modal.buttons.cancel.style);const r=document.createElement("button");r.type="button",r.innerHTML=this.linkOptions.modal.buttons.remove.icon,r.className=this.linkOptions.modal.buttons.remove.className,Object.assign(r.style,this.linkOptions.modal.buttons.remove.style),e.appendChild(i),e.appendChild(s),e.appendChild(o),e.appendChild(r),e.appendChild(n),t.appendChild(e);const a=document.createElement("div");return a.className=this.linkOptions.modal.background.className||"",Object.assign(a.style,this.linkOptions.modal.background.style),{dialog:t,background:a,form:e,label:i,input:s,okButton:o,cancelButton:n,removeButton:r}};_positionModal(t){const e=this.formatter.overlay.getBoundingClientRect(),i=this.formatter.quill.root.getBoundingClientRect(),s=t.offsetParent?.getBoundingClientRect()??{top:0,left:0},o=t.offsetWidth,n=t.offsetHeight;let r=e.left+e.width/2-o/2-s.left,a=e.top+e.height/2-n/2-s.top;const l=i.left-s.left,h=i.right-o-s.left;r=Math.min(Math.max(r,l),h),t.style.position="absolute",t.style.left=`${r}px`,t.style.top=`${a}px`}hideLinkModal=()=>{this.modal?.dialog?.open&&this.modal.dialog.close(),this.modal?.dialog?.remove(),this.modal?.background&&this.modal.background.remove(),this._removeEventListeners(),this.modal=void 0};_formSubmitHandler=t=>{t.preventDefault();const e=t.target,i=new FormData(e).get("url").trim();this.currentBlot&&(i?this.applyLink(i):this.removeLink())};getLink=()=>{const t=this.currentBlot;if(!t||!t.domNode)return null;const e=this.formatter.quill.getIndex(t);return this.formatter.quill.getFormat(e,1,r().sources.SILENT).link||null};removeLink=()=>{const t=this.currentBlot;if(!t||!t.domNode)return;let e=t.parent;for(;e&&"function"==typeof e.formats;){if(e.formats().link){e.format("link",null);break}e=e.parent}this.hideLinkModal(),this.toolbarButton.selected=!1};applyLink=t=>{t!==this.getLink()&&(this.removeLink(),this.currentBlot?.format("link",t),this.toolbarButton.selected=!!t),this.hideLinkModal()}}class z extends w{img;constructor(t){super(t),this.img=null}init(){this.formatter.quill.root.addEventListener("click",this.onClick)}getActions(){const t=super.getActions();return this.formatter.options.image.linkOptions.allowLinkEdit&&t.push(new A(this.formatter)),this.formatter.options.image.allowAltTitleEdit&&t.push(new L(this.formatter)),this.formatter.options.image.allowCompressor&&M.isEligibleForCompression(this.img)&&t.push(new M(this.formatter)),t}getTargetElement(){return this.img}onHide(){this.img=null}onClick=t=>{const e=t.target;e instanceof HTMLImageElement&&(t.stopImmediatePropagation(),t.preventDefault(),this.img=e,this.formatter.show(this))}}const I='<svg viewBox="0 0 16 16" fill="currentColor" style="height:100%;width:auto"><path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm3.354 4.646L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 1 1 .708-.708"/></svg>',T='<svg viewBox="0 0 24 24" fill="currentcolor" style="height:100%;width:auto"><path fill-rule="evenodd" clip-rule="evenodd" d="M 12,24 C 6.34314,24 3.514716,24 1.757364,22.2426 0,20.48532 0,17.6568 0,12 0,6.34314 0,3.514716 1.757364,1.757364 3.514716,0 6.34314,0 12,0 17.6568,0 20.48532,0 22.2426,1.757364 24,3.514716 24,6.34314 24,12 24,17.6568 24,20.48532 22.2426,22.2426 20.48532,24 17.6568,24 12,24 Z M 16.83636,8.363604 c 0.35148,0.351468 0.35148,0.921324 0,1.272756 l -6,6 c -0.35148,0.35148 -0.92124,0.35148 -1.272756,0 l -2.4,-2.4 c -0.351468,-0.35148 -0.351468,-0.92124 0,-1.27272 0.351468,-0.35148 0.921324,-0.35148 1.272792,0 L 10.2,13.72716 15.56364,8.363604 c 0.35148,-0.351468 0.92124,-0.351468 1.27272,0 z" style="stroke-width:1.2" /></svg>',O={specs:[z,C],overlay:{className:"blot-formatter__overlay",style:{position:"absolute",boxSizing:"border-box",border:"1px dashed #444",backgroundColor:"rgba(255, 255, 255, 0.35)",maxWidth:"100%"},sizeInfoStyle:{position:"absolute",color:"rgba(255, 255, 255, 0.7)",backgroundColor:"rgba(0, 0, 0, 0.7)",top:"50%",left:"50%",transform:"translate(-50%, -50%)",padding:"1em",textWrap:"nowrap",fontSize:"1rem",opacity:0,lineHeight:1.2}},align:{allowAligning:!0,alignments:["left","center","right"]},resize:{allowResizing:!0,allowResizeModeChange:!1,imageOversizeProtection:!1,handleClassName:"blot-formatter__resize-handle",handleStyle:{position:"absolute",height:"12px",width:"12px",backgroundColor:"white",border:"1px solid #777",boxSizing:"border-box",opacity:"0.80"},useRelativeSize:!1,minimumWidthPx:25},delete:{allowKeyboardDelete:!0},toolbar:{icons:{left:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"></line><line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"></line><line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"></line></svg>',center:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"></line><line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"></line><line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"></line></svg>',right:'<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"></line><line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"></line><line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"></line></svg>',attribute:'<svg viewBox="0 0 24 24" fill="none" class="ql-stroke"><path d="M10 19H12M12 19H14M12 19V5M12 5H6V6M12 5H18V6" stroke-linecap="round" stroke-linejoin="round"/></svg>',resizeMode:'<svg viewBox="0 0 24 24" class="ql-stroke"><path d="m 7.7056591,11.853515 q -1.515179,0 -2.4160962,-0.993056 -0.9009172,-1.0032944 -0.9009172,-2.6720388 0,-1.8223098 0.9521057,-2.8665548 0.9521057,-1.0544826 2.5696616,-1.0544826 1.5663674,0 2.426334,0.9725811 0.870204,0.972581 0.870204,2.7334647 0,1.7608836 -0.972581,2.8256044 -0.9623435,1.054482 -2.5287109,1.054482 z M 7.8489868,5.3935293 q -0.9725811,0 -1.5356544,0.7268764 -0.5630732,0.7166387 -0.5630732,1.9758752 0,1.2387612 0.5528356,1.9349241 0.5528355,0.685926 1.5049412,0.685926 0.9623434,0 1.5049413,-0.716639 0.5425978,-0.7166384 0.5425978,-1.9861126 0,-1.2387612 -0.5425978,-1.9246868 Q 8.7806171,5.3935293 7.8489868,5.3935293 Z M 17.533847,4.4926121 8.1151669,19.275845 H 6.6511764 L 16.059619,4.4926121 Z M 16.448651,19.398697 q -1.515179,0 -2.416096,-1.003294 -0.900917,-1.003294 -0.900917,-2.661801 0,-1.82231 0.962343,-2.876793 0.962344,-1.06472 2.559424,-1.06472 1.55613,0 2.426334,0.982819 0.870204,0.982819 0.870204,2.75394 0,1.750646 -0.972581,2.815366 -0.962343,1.054483 -2.528711,1.054483 z m 0.143328,-6.449748 q -0.982819,0 -1.545892,0.716638 -0.552836,0.716639 -0.552836,1.986113 0,1.218286 0.552836,1.914449 0.552835,0.685926 1.504941,0.685926 0.962343,0 1.504941,-0.716639 0.542598,-0.726876 0.542598,-1.986113 0,-1.248998 -0.542598,-1.924686 -0.53236,-0.675688 -1.46399,-0.675688 z" style="fill:currentColor;stroke:currentColor;stroke-width:0.3"/></svg>',compress:'<svg viewBox="0 0 28 28"><path d="m 19.250001,9.3125004 c 0.240623,0 0.437498,0.1968749 0.437498,0.4374991 V 18.49453 l -0.136717,-0.177734 -3.718751,-4.812498 c -0.123046,-0.161329 -0.317188,-0.254297 -0.51953,-0.254297 -0.202345,0 -0.39375,0.09297 -0.519532,0.254297 l -2.269532,2.936715 -0.833984,-1.167577 c -0.123047,-0.172265 -0.319922,-0.273437 -0.533204,-0.273437 -0.213281,0 -0.410156,0.101172 -0.533202,0.276172 l -2.1875003,3.0625 -0.1230462,0.169532 v -0.0082 -8.7500002 c 0,-0.2406242 0.1968749,-0.4374991 0.4374991,-0.4374991 z M 8.7499996,8 C 7.7847663,8 7,8.7847662 7,9.7499995 V 18.5 c 0,0.965233 0.7847663,1.75 1.7499996,1.75 H 19.250001 C 20.215235,20.25 21,19.465233 21,18.5 V 9.7499995 C 21,8.7847662 20.215235,8 19.250001,8 Z M 10.9375,13.250001 a 1.3125025,1.312501 0 1 0 0,-2.625002 1.3125025,1.312501 0 1 0 0,2.625002 z" /><path d="m 25.298508,20 h -3.58209 C 21.286567,20 21,20.286571 21,20.716427 v 3.582131 c 0,0.429856 0.286567,0.716426 0.716418,0.716426 v 0 c 0.429851,0 0.716418,-0.28657 0.716418,-0.716426 v -2.865705 h 2.865672 c 0.429851,0 0.716418,-0.28657 0.716418,-0.716426 C 26.014926,20.286571 25.728359,20 25.298508,20 Z" /><path d="M 6.298508,20 H 2.716418 C 2.2865673,20 2,20.286571 2,20.716427 c 0,0.429856 0.2865673,0.716426 0.716418,0.716426 H 5.58209 v 2.865705 c 0,0.429856 0.286567,0.716426 0.716418,0.716426 v 0 c 0.429851,0 0.716418,-0.28657 0.716418,-0.716426 V 20.716427 C 7.014926,20.286571 6.728359,20 6.298508,20 Z" /><path d="M 6.298507,3 C 5.868656,3 5.582089,3.28657 5.582089,3.716426 V 6.582131 H 2.716417 C 2.286567,6.582131 2,6.868702 2,7.298557 2,7.728413 2.286567,8.014984 2.716417,8.014984 h 3.58209 c 0.429845,0 0.716412,-0.286571 0.716412,-0.716427 V 3.716426 C 7.014919,3.28657 6.728352,3 6.298507,3 Z" /><path d="m 21.716418,8.014984 h 3.582089 c 0.429851,0 0.716418,-0.286571 0.716418,-0.716427 0,-0.429855 -0.286567,-0.716426 -0.716418,-0.716426 H 22.432836 V 3.716426 C 22.432836,3.28657 22.146269,3 21.716418,3 21.286567,3 21,3.28657 21,3.716426 v 3.582131 c 0,0.429856 0.286567,0.716427 0.716418,0.716427 z" /></svg>',link:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" style="fill: none;stroke: #444;stroke-linecap: round;stroke-linejoin: round;stroke-width: 1.5;"><line x1="7" x2="11" y1="7" y2="11"/><path class="ql-even" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"/><path class="ql-even" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"/></svg>'},tooltips:{left:"Align Left",center:"Align Center",right:"Align Right",attribute:"Set Alt/Title",resizeMode:"Resize Relative/Absolute",compress:"Compress Image",link:"Add/Edit Link"},mainClassName:"blot-formatter__toolbar",mainStyle:{position:"absolute",display:"flex",top:"0",right:"0",left:"0",transform:"translateY(-50%)",justifyContent:"center",flexWrap:"wrap",color:"#333",zIndex:"1"},buttonClassName:"blot-formatter__toolbar-button",buttonStyle:{display:"inline-block",width:"27px",height:"26px",background:"white",border:"1px solid #999",cursor:"pointer",margin:"0 -1px 0 0"},buttonSelectedClassName:"blot-formatter__toolbar-button--selected",buttonSelectedStyle:{filter:"invert(20%)"},svgStyle:{display:"inline-block",width:"100%",height:"100%",background:"white",verticalAlign:"top"}},image:{allowAltTitleEdit:!0,registerImageTitleBlot:!1,registerArrowRightFix:!0,altTitleModalOptions:{styles:{modalBackground:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},modalContainer:{backgroundColor:"#f2f2f2",padding:"5px 10px 10px 10px",borderRadius:"5px",position:"relative",width:"90%",maxWidth:"500px",boxShadow:"6px 6px 5px #00000075"},label:{display:"block",color:"black",margin:"7px 0 5px 0",fontSize:"14px"},textarea:{backgroundColor:"white",fontSize:"13px",display:"block",resize:"none",width:"100%",padding:"5px",border:"1px solid lightgray",borderRadius:"4px"},submitButton:{display:"block",marginLeft:"auto",marginTop:"5px",cursor:"pointer",border:0,padding:0,width:"2rem",height:"2rem",color:"#198754"},cancelButton:{display:"flex",width:"1.5rem",height:"1.5rem",position:"absolute",padding:0,top:"-0.7rem",right:"-0.7rem",background:"white",border:"none",borderRadius:"5px",cursor:"pointer",alignItems:"center",color:"rgb(197, 74, 71)"}},icons:{submitButton:T,cancelButton:I},labels:{alt:"Alt Text",title:"Image Title"}},allowCompressor:!1,compressorOptions:{jpegQuality:.8,styles:{modalBackground:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},modalContainer:{backgroundColor:"rgb(253, 253, 253)",border:"1px solid #ccc",boxShadow:"6px 6px 5px #00000075",padding:"15px",borderRadius:"8px",position:"relative",maxWidth:"min(90%, 400px)",textAlign:"justify",userSelect:"none"},buttonContainer:{gridTemplateColumns:"auto 1fr auto",display:"grid",gap:"1em",justifyItems:"center",borderTop:"1px solid lightgray",paddingTop:"12px"},buttons:{width:"1.5rem",height:"1.5rem",padding:0,backgroundColor:"transparent",border:0,cursor:"pointer"}},buttons:{continue:{className:"blot-formatter__compress-continue",style:{color:"#198754"}},cancel:{className:"blot-formatter__compress-cancel",style:{color:"rgb(197, 74, 71)"}},moreInfo:{className:"blot-formatter__compress-more-info",style:{color:"royalblue"}}},text:{prompt:"<h5>Compress image to its resized width?</h5>",moreInfo:'<p style="font-size: smaller; line-height: 1.2;">You can reduce the file size and save disk space by compressing pictures. The compression reduces both the file size and picture dimensions based on the width setting.</p><p style="font-size: smaller;"><strong>NOTE:</strong> This process cannot be undone.</p>',reducedLabel:"Reduced",nothingToDo:"Image already optimised."},icons:{cancel:`<span style="color: rgb(197, 74, 71);">${I}</span>`,moreInfo:'<svg viewBox="0 0 512 512" fill="currentcolor" style="height:100%;width:auto"><path d="M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm169.8-90.7c7.9-22.3 29.1-37.3 52.8-37.3l58.3 0c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24l0-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1l-58.3 0c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z" /></svg>',continue:T}},linkOptions:{allowLinkEdit:!0,modal:{dialog:{className:"blot-formatter__link-modal",style:{margin:0,backgroundColor:"#fdfdfd",border:"1px solid #ccc",boxShadow:"6px 6px 5px #00000075",color:"#444",padding:"6px 13px 6px 10px",whiteSpace:"nowrap",borderRadius:"5px",minWidth:"300px",maxWidth:"90%",overflow:"visible",zIndex:101}},background:{className:"blot-formatter__link-modal-background",style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.5)",zIndex:100}},form:{className:"blot-formatter__link-form",style:{display:"flex",flexWrap:"nowrap",columnGap:"5px",alignItems:"baseline"}},label:{className:"blot-formatter__link-label",style:{paddingRight:"5px",fontSize:"13px"},text:"URL:"},input:{className:"blot-formatter__link-input",style:{border:"1px solid #ccc",borderRadius:"4px",fontSize:"13px",height:"25px",margin:0,padding:"3px 5px",width:"100%",outline:"1px auto #df9001c2"},placeholder:"https://example.com"},buttons:{submit:{className:"blot-formatter__link-submit",style:{border:"none",borderRadius:"3px",padding:"0",cursor:"pointer",background:"transparent",width:"26px",height:"26px",color:"#198754"},icon:'<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16" style="height:100%;width:auto"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"/><path d="M10.97 4.97a.75.75 0 0 1 1.071 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425z"/></svg>',tooltip:"Create Link"},cancel:{className:"blot-formatter__link-cancel",style:{display:"flex",width:"18px",height:"18px",position:"absolute",top:"-8px",right:"-10px",padding:"0",background:"white",border:"1px solid rgb(157, 58, 56)",borderRadius:"5px",cursor:"pointer",alignItems:"center",color:"rgb(197, 74, 71)"},icon:I,tooltip:"Cancel"},remove:{className:"blot-formatter__link-remove",style:{border:"none",padding:"0",cursor:"pointer",background:"transparent",width:"26px",height:"26px",fill:"#c54a47"},icon:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" viewBox="0 0 16 16" style="height:100%;width:auto"><path d="M 6.265625,3.3457031 6.125,3.625 H 4.25 c -0.3457031,0 -0.625,0.2792969 -0.625,0.625 0,0.3457031 0.2792969,0.625 0.625,0.625 h 7.5 c 0.345703,0 0.625,-0.2792969 0.625,-0.625 0,-0.3457031 -0.279297,-0.625 -0.625,-0.625 H 9.875 L 9.734375,3.3457031 C 9.6289062,3.1328125 9.4121094,3 9.1757812,3 H 6.8242188 C 6.5878906,3 6.3710938,3.1328125 6.265625,3.3457031 Z M 11.75,5.5 h -7.5 l 0.4140625,6.621094 C 4.6953125,12.615234 5.1054688,13 5.5996094,13 h 4.8007816 c 0.49414,0 0.904297,-0.384766 0.935547,-0.878906 z" style="display:inline;stroke-width:0.0195312"/><path d="m 14,1 a 1,1 0 0 1 1,1 v 12 a 1,1 0 0 1 -1,1 H 2 A 1,1 0 0 1 1,14 V 2 A 1,1 0 0 1 2,1 Z M 2,0 A 2,2 0 0 0 0,2 v 12 a 2,2 0 0 0 2,2 h 12 a 2,2 0 0 0 2,-2 V 2 A 2,2 0 0 0 14,0 Z" style="display:inline"/></svg>',tooltip:"Remove Link"}}}}},video:{selector:"iframe.ql-video",registerCustomVideoBlot:!1,registerBackspaceFix:!0,defaultAspectRatio:"16/9 auto",proxyStyle:{}}},B=r().import("formats/image"),R=["alt","height","width","title"];const H=class extends B{static formats(t){return R.reduce((e,i)=>(t.hasAttribute(i)&&(e[i]=t.getAttribute(i)),e),{})}format(t,e){R.indexOf(t)>-1?e||"alt"===t?this.domNode.setAttribute(t,e):this.domNode.removeAttribute(t):super.format(t,e)}},N=r().import("formats/video");const q=class extends N{static aspectRatio="16 / 9 auto";static create(t){const e=super.create(t);return e.setAttribute("width","100%"),e.style.aspectRatio=this.aspectRatio,e}html(){return this.domNode.outerHTML}};class W{formatter;element;buttons={};constructor(t){this.formatter=t,this.element=document.createElement("div"),this.element.classList.add(this.formatter.options.toolbar.mainClassName),this.element.addEventListener("mousedown",t=>{t.stopPropagation()}),this.formatter.options.toolbar.mainStyle&&Object.assign(this.element.style,this.formatter.options.toolbar.mainStyle)}create(){const t=[];this.formatter.actions.forEach(e=>{e.toolbarButtons.forEach(e=>{this.buttons[e.action]=e,t.push(e.create())})}),this.element.append(...t),this.formatter.overlay.append(this.element)}destroy(){this.element&&this.formatter.overlay.removeChild(this.element);for(const t of Object.values(this.buttons))t.destroy();this.buttons={},this.element.innerHTML=""}}const j=(t,e)=>e;var D;!function(t){t.LEFT="left",t.RIGHT="right",t.ABOVE="above",t.BELOW="below",t.INSIDE="inside"}(D||(D={}));class P{quill;options;currentSpec;specs;overlay;toolbar;sizeInfo;actions;startX=0;startY=0;constructor(t,e={}){if(this.quill=t,this.currentSpec=null,this.actions=[],t.options.readOnly)return this.options=O,this.toolbar=new W(this),this.specs=[],this.overlay=document.createElement("div"),void(this.sizeInfo=document.createElement("div"));this.options=l()(O,e,{arrayMerge:j}),[this.overlay,this.sizeInfo]=this.createOverlay(),this.addEventListeners(),this.toolbar=new W(this),this.specs=this.options.specs.map(t=>new t(this)),this.specs.forEach(t=>t.init()),this.quill.container.style.position=this.quill.container.style.position||"relative",this.registerCustomBlots(),this.keyboardBindings()}show(t){this.quill.container.querySelectorAll(".ql-tooltip:not(.ql-hidden)").forEach(t=>{t.classList.add("ql-hidden")}),window.bf=this,this.hide(),this.currentSpec=t,this.currentSpec.setSelection(),this.setUserSelect("none"),this.quill.container.appendChild(this.overlay),this.repositionOverlay(),this.createActions(t),this.toolbar.create(),document.addEventListener("pointerdown",this.onDocumentPointerDown)}hide(t=null){if(this.currentSpec){if(t){const e=this.currentSpec.getTargetBlot();if(e){const i=this.getClickPosition(t);i===D.LEFT?E.placeCaretBeforeBlot(this.quill,e):i===D.RIGHT&&E.placeCaretAfterBlot(this.quill,e)}}this.currentSpec.onHide(),this.currentSpec=null,this.quill.container.removeChild(this.overlay),document.removeEventListener("pointerdown",this.onDocumentPointerDown),this.overlay.style.setProperty("display","none"),this.setUserSelect(""),this.destroyActions(),this.toolbar.destroy(),this.quill.emitter.emit(this.quill.constructor.events.TEXT_CHANGE,0,this.quill.getLength(),"api")}}update(){this.repositionOverlay(),this.actions.forEach(t=>t.onUpdate())}createActions(t){this.actions=t.getActions().map(t=>(t.onCreate(),t))}destroyActions(){this.actions.forEach(t=>t.onDestroy()),this.actions=[]}createOverlay(){const t=document.createElement("div");t.classList.add(this.options.overlay.className),this.options.overlay.style&&Object.assign(t.style,this.options.overlay.style),t.style.userSelect="none",t.style.setProperty("-webkit-user-select","none"),t.style.setProperty("-moz-user-select","none"),t.style.setProperty("-ms-user-select","none");const e=document.createElement("div");return this.options.overlay.sizeInfoStyle&&Object.assign(e.style,this.options.overlay.sizeInfoStyle),t.appendChild(e),[t,e]}addEventListeners(){this.overlay.addEventListener("wheel",this.passWheelEventThrough,{passive:!1}),this.overlay.addEventListener("touchstart",this.onTouchScrollStart,{passive:!1}),this.overlay.addEventListener("touchmove",this.onTouchScrollMove,{passive:!1}),this.overlay.addEventListener("contextmenu",t=>{t.stopPropagation(),t.preventDefault()}),this.repositionOverlay=this.repositionOverlay.bind(this),this.quill.root.addEventListener("scroll",this.repositionOverlay),new ResizeObserver(()=>{this.repositionOverlay()}).observe(this.quill.root),this.quill.root.addEventListener("click",this.onClick)}repositionOverlay(){if(this.currentSpec){const t=this.currentSpec.getOverlayElement();if(t){const e=this.quill.container.getBoundingClientRect(),i=t.getBoundingClientRect();Object.assign(this.overlay.style,{display:"block",left:`${i.left-e.left-1+this.quill.container.scrollLeft}px`,top:`${i.top-e.top+this.quill.container.scrollTop}px`,width:`${i.width}px`,height:`${i.height}px`})}}}setUserSelect(t){["userSelect","mozUserSelect","webkitUserSelect","msUserSelect"].forEach(e=>{this.quill.root.style.setProperty(e,t),document.documentElement&&document.documentElement.style.setProperty(e,t)})}onDocumentPointerDown=t=>{const e=t.target;this.quill.root.parentNode.contains(e)||e.closest("[data-blot-formatter-modal]")||e.classList.contains("blot-formatter__proxy-image")||this.hide(t)};onClick=t=>{this.hide(t)};passWheelEventThrough=t=>{this.quill.root.scrollLeft+=t.deltaX,this.quill.root.scrollTop+=t.deltaY};onTouchScrollStart=t=>{if(1===t.touches.length){const e=t.touches[0];this.startX=e.clientX,this.startY=e.clientY}};onTouchScrollMove=t=>{if(1===t.touches.length){const e=t.touches[0],i=this.startX-e.clientX,s=this.startY-e.clientY,o=this.quill.root,n=0===o.scrollTop,r=o.scrollTop+o.clientHeight===o.scrollHeight,a=0===o.scrollLeft,l=o.scrollLeft+o.clientWidth===o.scrollWidth,h=Math.abs(s)>Math.abs(i),c=Math.abs(i)>Math.abs(s);let d=!1;h&&(n&&s<0||r&&s>0||(d=!0,o.scrollTop+=s)),c&&(a&&i<0||l&&i>0||(d=!0,o.scrollLeft+=i)),d&&t.preventDefault(),this.startX=e.clientX,this.startY=e.clientY}};onOverlayTouchScrollMove=t=>{this.onTouchScrollMove(t),this.repositionOverlay()};registerCustomBlots(){this.options.image.registerImageTitleBlot&&r().register(H,!0),this.options.video.registerCustomVideoBlot&&(q.aspectRatio=this.options.video.defaultAspectRatio,r().register(q,!0))}keyboardBindings(){this.options.video.registerBackspaceFix&&(this.quill.keyboard.bindings.Backspace||(this.quill.keyboard.bindings.Backspace=[]),this.quill.keyboard.bindings.Backspace.unshift({key:"Backspace",empty:!0,line:{domNode:{tagName:"IFRAME"}},handler:t=>{this.quill.deleteText(t.index-1,1,"user")}})),this.options.image.registerArrowRightFix&&(this.quill.keyboard.bindings.ArrowRight||(this.quill.keyboard.bindings.ArrowRight=[]),this.quill.keyboard.bindings.ArrowRight.unshift({key:"ArrowRight",collapsed:!0,empty:!1,suffix:/^$/,line:{domNode:{tagName:"P"}},handler:(t,e)=>{const i=t.index+t.length,s=this.quill.getLength();i+1>=s-1?this.quill.setSelection(s-1,0,"user"):(this.quill.setSelection(i+2,0,"user"),E.sendCaretBack(1))}}))}useRelative(t){if(this.options.resize.allowResizeModeChange){const e=t.getAttribute("width");return e?e.endsWith("%"):this.options.resize.useRelativeSize}return this.options.resize.useRelativeSize}getClickPosition=t=>{const e=this.overlay.getBoundingClientRect();return t.clientY<e.top?D.ABOVE:t.clientY>e.bottom?D.BELOW:t.clientX<e.left?D.LEFT:t.clientX>e.right?D.RIGHT:D.INSIDE}}return o})());