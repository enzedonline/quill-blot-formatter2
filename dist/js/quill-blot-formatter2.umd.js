!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("quill")):"function"==typeof define&&define.amd?define(["exports","quill"],e):e((t||self).QuillBlotFormatter2={},t.quill)}(this,function(t,e){function i(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var n=/*#__PURE__*/i(e);function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,u(n.key),n)}}function a(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(){return s=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)({}).hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},s.apply(null,arguments)}function l(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,c(t,e)}function c(t,e){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},c(t,e)}function u(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}var d=/*#__PURE__*/function(){function t(t){this.formatter=void 0,this.toolbarButtons=[],this.formatter=t}var e=t.prototype;return e.onCreate=function(){},e.onDestroy=function(){},e.onUpdate=function(){},t}();n.default.import("blots/inline");var h=n.default.import("parchment"),m=h.ClassAttributor,p=h.Scope,f=new(/*#__PURE__*/function(t){function e(){return t.call(this,"iframeAlign","ql-iframe-align",{scope:p.BLOCK,whitelist:["left","center","right"]})||this}l(e,t);var i=e.prototype;return i.add=function(e,i){if(e instanceof HTMLElement){"object"==typeof i?(t.prototype.add.call(this,e,i.align),e.dataset.blotAlign=i.align):(t.prototype.add.call(this,e,i),e.dataset.blotAlign=i);var n=e.getAttribute("width");return n?(isNaN(Number(n.trim().slice(-1)))||(n+="px"),e.style.setProperty("--resize-width",n),e.dataset.relativeSize=""+n.endsWith("%")):(e.style.removeProperty("--resize-width"),e.dataset.relativeSize="false"),!0}return!1},i.remove=function(e){e instanceof HTMLElement&&(t.prototype.remove.call(this,e),delete e.dataset.blotAlign)},i.value=function(e){var i=t.prototype.value.call(this,e),n=e instanceof HTMLElement&&(e.style.getPropertyValue("--resize-width")||e.getAttribute("width"))||"";return{align:i,width:n,relativeSize:""+n.endsWith("%")}},e}(m)),g=/*#__PURE__*/function(t){function e(){var e;return(e=t.call(this,"imageAlign","ql-image-align",{scope:p.INLINE,whitelist:["left","center","right"]})||this).getImageWidth=function(t){var e=t.getAttribute("width");return e?isNaN(Number(e.trim().slice(-1)))||t.setAttribute("width",e+="px"):t.setAttribute("width",e=t.naturalWidth+"px"),t.parentElement.style.setProperty("--resize-width",e),e},e}l(e,t);var i=e.prototype;return i.add=function(e,i){if(e instanceof HTMLSpanElement&&i){var o=e.querySelector("img");if("object"==typeof i&&i.align)t.prototype.add.call(this,e,i.align),e.setAttribute("contenteditable","false"),i.title?e.setAttribute("data-title",i.title):e.removeAttribute("data-title"),i.align&&(o.dataset.blotAlign=i.align);else{if("string"!=typeof i)return!1;t.prototype.add.call(this,e,i),o.dataset.blotAlign=i}var r=this.getImageWidth(o);return e.setAttribute("data-relative-size",""+(null==r?void 0:r.endsWith("%"))),!0}var a=e.querySelector("img");if(a instanceof HTMLImageElement){var s,l=n.default.find(a);return l&&(e.firstChild instanceof HTMLSpanElement||null==(s=a.parentElement)||!s.matches('span[class^="ql-image-align-"]'))&&l.format("imageAlign",i),!0}return!1},i.remove=function(e){e instanceof HTMLElement&&(t.prototype.remove.call(this,e),e.firstChild&&e.firstChild instanceof HTMLElement&&delete e.firstChild.dataset.blotAlign)},i.value=function(e){var i=this,n=e.querySelector("img"),o=t.prototype.value.call(this,n.parentElement),r=n.getAttribute("title")||"",a=n.getAttribute("width")||"";return parseFloat(a)||(n.complete?a=this.getImageWidth(n):n.onload=function(t){a=i.getImageWidth(t.target)}),{align:o,title:r,width:a,contenteditable:"false",relativeSize:""+a.endsWith("%")}},e}(m);g.tagName="SPAN";var v=new g;n.default.register({"formats/imageAlign":v,"attributors/class/imageAlign":v,"formats/iframeAlign":f,"attributors/class/iframeAlign":f},!0);var y=n.default.import("parchment").Scope,b=/*#__PURE__*/function(){function t(t){var e=this;this.alignments={},this.options=void 0,this.formatter=void 0,this.formatter=t,this.options=t.options,this.options.align.alignments.forEach(function(t){e.alignments[t]={name:t,apply:function(i){e.setAlignment(i,t)}}})}var e=t.prototype;return e.getAlignments=function(){var t=this;return Object.keys(this.alignments).map(function(e){return t.alignments[e]})},e.clear=function(t){null!=t&&("IMG"===t.domNode.tagName?null!==t.parent&&"SPAN"===t.parent.domNode.tagName&&t.parent.format(v.attrName,!1):"IFRAME"===t.domNode.tagName&&t.format(f.attrName,!1))},e.isInlineBlot=function(t){var e;return((null==(e=t.statics)?void 0:e.scope)&y.INLINE)===y.INLINE_BLOT},e.isBlockBlot=function(t){var e;return((null==(e=t.statics)?void 0:e.scope)&y.BLOCK)===y.BLOCK_BLOT},e.hasInlineScope=function(t){return(t.statics.scope&y.INLINE)===y.INLINE},e.hasBlockScope=function(t){return(t.statics.scope&y.BLOCK)===y.BLOCK},e.isAligned=function(t,e){var i=this.getAlignment(t);return e?i===e.name:!!i},e.getAlignment=function(t){return t.domNode.dataset.blotAlign},e.setAlignment=function(t,e){if(null!=t){var i=this.isAligned(t,this.alignments[e]);if(this.clear(t),!i)if(this.isInlineBlot(t)||this.hasInlineScope(t)){if(!t.domNode.getAttribute("width")&&this.formatter.options.resize.useRelativeSize&&!this.formatter.options.resize.allowResizeModeChange)try{var n=getComputedStyle(this.formatter.quill.root),o=this.formatter.quill.root.clientWidth-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight);t.domNode.setAttribute("width",Math.min(Math.round(100*t.domNode.naturalWidth/o),100)+"%")}catch(t){}t.format(v.attrName,{align:this.alignments[e].name,title:t.domNode.getAttribute("title")||""});try{var r=this.formatter.quill.getContents().ops;2===r.length&&"\n"===r[1].insert&&this.formatter.quill.insertText(this.formatter.quill.getLength(),"\n","user")}catch(t){}}else(this.isBlockBlot(t)||this.hasBlockScope(t))&&t.format(f.attrName,this.alignments[e].name)}},t}(),x=/*#__PURE__*/function(){function t(t,e,i){this.action=void 0,this.icon=void 0,this.onClick=void 0,this.options=void 0,this.element=null,this.initialVisibility=!0,this.action=t,this.icon=i.icons[t],this.onClick=e,this.options=i}var e=t.prototype;return e.create=function(){return this.element=document.createElement("span"),this.element.innerHTML=this.icon,this.element.className=this.options.buttonClassName,this.styleButton(),this.element.dataset.action=this.action,this.selected=this.preselect(),this.element.onclick=this.onClick,this.visible=this.initialVisibility,this.element},e.destroy=function(){this.element&&(this.element.onclick=null,this.element.remove(),this.element=null)},e.preselect=function(){return!1},e.styleButton=function(){if(this.element&&(this.options.buttonStyle&&Object.assign(this.element.style,this.options.buttonStyle),this.options.svgStyle)){var t=this.element.children[0];t&&Object.assign(t.style,this.options.svgStyle)}},a(t,[{key:"selected",get:function(){var t;return"true"===(null==(t=this.element)?void 0:t.dataset.selected)},set:function(t){this.element&&(this.element.dataset.selected=""+t,t?this.element.style.setProperty("filter","invert(20%)"):this.element.style.removeProperty("filter"))}},{key:"visible",get:function(){var t;return"none"!==(null==(t=this.element)?void 0:t.style.display)},set:function(t){this.element&&("boolean"==typeof t&&(t=t?"inline-block":"none"),this.element.style.display=t)}}])}(),w=/*#__PURE__*/function(t){function e(e){var i;return(i=t.call(this,e)||this).aligner=void 0,i.alignButtons={},i.onClickHandler=function(t){var e=t.target.closest("span."+i.formatter.options.toolbar.buttonClassName);if(e){var n,o=e.dataset.action||"",r=null==(n=i.formatter.currentSpec)?void 0:n.getTargetBlot();if(o&&r){var a=i.aligner.alignments[o];i.clearButtons(),i.aligner.isAligned(r,a)?i.aligner.clear(r):(i.aligner.setAlignment(r,o),i.alignButtons[o].selected=!0)}}i.formatter.update()},i.aligner=new b(e),i}l(e,t);var i=e.prototype;return i.createAlignmentButtons=function(){for(var t,e=0,i=Object.values(this.aligner.alignments);e<i.length;e++){var n=i[e];this.alignButtons[n.name]=new x(n.name,this.onClickHandler,this.formatter.options.toolbar)}var o=null==(t=this.formatter.currentSpec)?void 0:t.getTargetBlot();if(o){var r=this.aligner.getAlignment(o);r&&this.alignButtons[r]&&(this.alignButtons[r].preselect=function(){return!0})}},i.clearButtons=function(){for(var t=0,e=Object.values(this.alignButtons);t<e.length;t++)e[t].selected=!1},i.onCreate=function(){this.createAlignmentButtons(),this.toolbarButtons=Object.values(this.alignButtons)},i.onDestroy=function(){this.alignButtons={},this.toolbarButtons=[]},e}(d),E=/*#__PURE__*/function(t){function e(e){var i;return(i=t.call(this,e)||this).topLeftHandle=void 0,i.topRightHandle=void 0,i.bottomRightHandle=void 0,i.bottomLeftHandle=void 0,i.dragHandle=null,i.dragStartX=0,i.dragCursorStyle=void 0,i.preDragWidth=0,i.pinchStartDistance=0,i.calculatedAspectRatio=0,i.computedAspectRatio=void 0,i.target=void 0,i.editorStyle=void 0,i.editorWidth=0,i.useRelativeSize=void 0,i.resizeModeButton=null,i.isUnclickable=!1,i.hasResized=!1,i.formattedWidth="",i.sizeInfoTimerId=null,i.isImage=!1,i.isSVG=!1,i.naturalWidth=void 0,i.resizeMode=function(t){if(t){if(i.hasResized=!1,i.formattedWidth="",i.target){i.useRelativeSize=i.formatter.useRelative(i.target),i.editorStyle=getComputedStyle(i.formatter.quill.root),i.editorWidth=i.formatter.quill.root.clientWidth-parseFloat(i.editorStyle.paddingLeft)-parseFloat(i.editorStyle.paddingRight);var e=i.target.getBoundingClientRect();if(void 0!==e.height&&0!==e.height||(e.height=i.target.clientHeight+1),i.preDragWidth=e.width,i.computedAspectRatio=getComputedStyle(i.target).aspectRatio||"auto",i.calculatedAspectRatio=e.width/e.height,i.useRelativeSize)i.isUnclickable&&"auto"===i.computedAspectRatio&&(i.target.style.aspectRatio=i.formatter.options.video.defaultAspectRatio,console.warn('No iframe aspect-ratio set. Set an aspect ratio either via custom blot or css.\nUsing temporary aspect ratio "'+i.formatter.options.video.defaultAspectRatio+'"'));else if(i.isUnclickable&&"auto"!==i.computedAspectRatio){var n=i.computedAspectRatio.match(/(\d+)\s*\/\s*(\d+)/);if(n)try{i.calculatedAspectRatio=parseFloat(n[1])/parseFloat(n[2])}catch(t){}}i.isImage&&!i.useRelativeSize&&!i.isSVG&&i.formatter.options.resize.imageOversizeProtection&&(i.naturalWidth=i.target.naturalWidth),i.showSizeInfo(!0,e.width,e.height)}}else{if(i.target&&i.hasResized){var o=i.roundDimension(i.formattedWidth);i.target.setAttribute("width",o),i.formatter.toolbar.buttons.resizeMode&&(i.formatter.toolbar.buttons.resizeMode.selected=i.isRelative),i.isUnclickable?(i.target.style.setProperty("--resize-width",""+o),i.target.dataset.relativeSize=""+i.isRelative):i.isAligned&&i.target.parentElement&&(i.target.parentElement.style.setProperty("--resize-width",""+o),i.target.parentElement.dataset.relativeSize=""+i.isRelative)}i.naturalWidth=void 0,i.formatter.update(),i.showSizeInfo(!1)}},i.onHandlePointerDown=function(t){i.resizeMode(!0),t.target instanceof HTMLElement&&i.target&&(i.dragHandle=t.target,i.setCursor(i.dragHandle.style.cursor),i.dragStartX=t.clientX,document.addEventListener("pointermove",i.onHandleDrag),document.addEventListener("pointerup",i.onHandlePointerUp))},i.onHandleDrag=function(t){if(i.target){i.hasResized=!0;var e=t.clientX-i.dragStartX,n=0;n=i.dragHandle===i.topLeftHandle||i.dragHandle===i.bottomLeftHandle?Math.round(i.preDragWidth-e):Math.round(i.preDragWidth+e),n=Math.max(Math.min(n,i.editorWidth),i.formatter.options.resize.minimumWidthPx),i.resizeTarget(n)}},i.onHandlePointerUp=function(){i.setCursor(""),i.resizeMode(!1),document.removeEventListener("pointermove",i.onHandleDrag),document.removeEventListener("pointerup",i.onHandlePointerUp)},i.onOverlayTouchStart=function(t){t.target===i.formatter.overlay&&(i.resizeMode(!0),i.target&&2===t.touches.length&&(t.preventDefault(),i.pinchStartDistance=i.calculateDistance(t.touches[0],t.touches[1]),i.preDragWidth=i.target.clientWidth))},i.onOverlayTouchMove=function(t){if(t.target===i.formatter.overlay&&i.target&&2===t.touches.length&&null!==i.pinchStartDistance&&null!==i.preDragWidth&&(t.preventDefault(),i.target)){i.hasResized=!0;var e=i.calculateDistance(t.touches[0],t.touches[1]),n=Math.round(i.preDragWidth*(e/i.pinchStartDistance));n=Math.max(Math.min(n,i.editorWidth),10),i.resizeTarget(n)}},i.onOverlayTouchEnd=function(t){t.target===i.formatter.overlay&&i.resizeMode(!1)},i.onOverlayMouseDown=function(t){t.target===i.formatter.overlay&&i.resizeMode(!0)},i.onOverlayMouseUp=function(t){t.target===i.formatter.overlay&&i.resizeMode(!1)},i.onResizeModeClickHandler=function(t){t.stopImmediatePropagation(),i.swapResizeMode(!0)},i.topLeftHandle=i.createHandle("top-left","nwse-resize"),i.topRightHandle=i.createHandle("top-right","nesw-resize"),i.bottomRightHandle=i.createHandle("bottom-right","nwse-resize"),i.bottomLeftHandle=i.createHandle("bottom-left","nesw-resize"),i.dragCursorStyle=document.createElement("style"),i.useRelativeSize=i.formatter.options.resize.useRelativeSize,e.options.resize.allowResizeModeChange&&(i.resizeModeButton=i.createResizeModeButton(),i.toolbarButtons=[i.resizeModeButton]),i}l(e,t);var i=e.prototype;return i.onCreate=function(){var t,e;this.target=null==(t=this.formatter.currentSpec)?void 0:t.getTargetElement(),this.isUnclickable=(null==(e=this.formatter.currentSpec)?void 0:e.isUnclickable)||!1,this.isImage=this.target instanceof HTMLImageElement,this.isImage&&(this.isSVG=this.isSvgImage()),this.formatter.overlay.appendChild(this.topLeftHandle),this.formatter.overlay.appendChild(this.topRightHandle),this.formatter.overlay.appendChild(this.bottomRightHandle),this.formatter.overlay.appendChild(this.bottomLeftHandle),this.formatter.overlay.addEventListener("mousedown",this.onOverlayMouseDown),this.formatter.overlay.addEventListener("mouseup",this.onOverlayMouseUp),this.formatter.overlay.addEventListener("touchstart",this.onOverlayTouchStart,{passive:!1}),this.formatter.overlay.addEventListener("touchmove",this.onOverlayTouchMove,{passive:!1}),this.formatter.overlay.addEventListener("touchend",this.onOverlayTouchEnd,{passive:!1}),this.repositionHandles(this.formatter.options.resize.handleStyle||{})},i.onDestroy=function(){this.target=null,this.isUnclickable=!1,this.isImage=!1,this.naturalWidth=void 0,this.isSVG=!1,this.setCursor(""),this.formatter.overlay.removeChild(this.topLeftHandle),this.formatter.overlay.removeChild(this.topRightHandle),this.formatter.overlay.removeChild(this.bottomRightHandle),this.formatter.overlay.removeChild(this.bottomLeftHandle),this.formatter.overlay.removeEventListener("mousedown",this.onOverlayMouseDown),this.formatter.overlay.removeEventListener("mouseup",this.onOverlayMouseUp),this.formatter.overlay.removeEventListener("touchstart",this.onOverlayTouchStart,{passive:!1}),this.formatter.overlay.removeEventListener("touchmove",this.onOverlayTouchMove,{passive:!1}),this.formatter.overlay.removeEventListener("touchend",this.onOverlayTouchEnd,{passive:!1}),this.formatter.update()},i.createHandle=function(t,e){var i=document.createElement("div");return i.classList.add(this.formatter.options.resize.handleClassName),i.setAttribute("data-position",t),i.style.cursor=e,this.formatter.options.resize.handleStyle&&Object.assign(i.style,this.formatter.options.resize.handleStyle),i.addEventListener("pointerdown",this.onHandlePointerDown),i},i.repositionHandles=function(t){var e="0px",i="0px";t&&(t.width&&(e=-parseFloat(t.width)/2+"px"),t.height&&(i=-parseFloat(t.height)/2+"px")),Object.assign(this.topLeftHandle.style,{left:e,top:i}),Object.assign(this.topRightHandle.style,{right:e,top:i}),Object.assign(this.bottomRightHandle.style,{right:e,bottom:i}),Object.assign(this.bottomLeftHandle.style,{left:e,bottom:i})},i.setCursor=function(t){if(document.body)if(t)this.dragCursorStyle.innerHTML="body, body * { cursor: "+t+" !important; }",document.head.appendChild(this.dragCursorStyle);else try{document.head.removeChild(this.dragCursorStyle)}catch(t){}},i.resizeTarget=function(t){var e;this.target&&(t=Math.min(null!=(e=this.naturalWidth)?e:Infinity,t),this.updateSizeInfo(t,t/this.calculatedAspectRatio),this.formattedWidth=this.formatter.useRelative(this.target)?100*t/this.editorWidth+"%":t+"px",this.target.setAttribute("width",this.formattedWidth),this.target.setAttribute("height","auto"),this.isUnclickable?(this.useRelativeSize||"auto"!==this.computedAspectRatio||this.target.setAttribute("height",(t/this.calculatedAspectRatio|0)+"px"),this.target.style.setProperty("--resize-width",this.formattedWidth)):!this.isUnclickable&&this.isAligned&&this.target.parentElement&&this.target.parentElement.style.setProperty("--resize-width",this.formattedWidth),this.formatter.update())},i.showSizeInfo=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null),t?(this.cancelSizeInfoTimer(),null!==e&&null!==i&&this.updateSizeInfo(e,i),this.formatter.sizeInfo.style.transition="",this.formatter.sizeInfo.style.opacity="1"):this.closeSizeInfo()},i.updateSizeInfo=function(t,e){var i=(t=Math.round(t))+" x "+(e=Math.round(e))+"px";if(this.isRelative)i=Math.round(100*t/this.editorWidth)+"% ("+i+")";else if(!this.hasResized){var n,o=null==(n=this.target)?void 0:n.getAttribute("width");if(o){if(parseFloat(o)!==t){var r=t/e;i=o+" x "+Math.round(parseFloat(o)/r)+"px ("+i+")"}}else this.target instanceof HTMLImageElement&&this.target.naturalWidth!==t&&(i=this.target.naturalWidth+" x "+this.target.naturalHeight+"px ("+i+")")}this.formatter.sizeInfo.innerText=i},i.createResizeModeButton=function(){var t=this,e=new x("resizeMode",this.onResizeModeClickHandler,this.formatter.options.toolbar);return e.preselect=function(){return t.isRelative},e},i.swapResizeMode=function(t){if(void 0===t&&(t=!1),this.target){var e,i,n=this.target.getBoundingClientRect();this.editorStyle=getComputedStyle(this.formatter.quill.root),this.editorWidth=this.formatter.quill.root.clientWidth-parseFloat(this.editorStyle.paddingLeft)-parseFloat(this.editorStyle.paddingRight),i=this.isRelative?Math.round(n.width)+"px":Math.round(100*n.width/this.editorWidth)+"%",this.target.setAttribute("width",""+i),this.target.setAttribute("height","auto"),null!=(e=this.formatter.currentSpec)&&e.isUnclickable?(this.target.style.setProperty("--resize-width",""+i),this.target.dataset.relativeSize=""+this.isRelative):this.isAligned&&this.target.parentElement&&(this.target.parentElement.style.setProperty("--resize-width",""+i),this.target.parentElement.dataset.relativeSize=""+this.isRelative),this.formatter.toolbar.buttons.resizeMode.selected=this.isRelative,this.formatter.update(),t&&(this.showSizeInfo(!0,n.width,n.height),this.showSizeInfo(!1))}},i.closeSizeInfo=function(){var t=this;this.sizeInfoTimerId=setTimeout(function(){t.formatter.sizeInfo.style.transition="opacity 1s",t.formatter.sizeInfo.style.opacity="0"},1e3)},i.cancelSizeInfoTimer=function(){null!==this.sizeInfoTimerId&&(clearTimeout(this.sizeInfoTimerId),this.sizeInfoTimerId=null)},i.calculateDistance=function(t,e){var i=e.clientX-t.clientX,n=e.clientY-t.clientY;return Math.sqrt(i*i+n*n)},i.roundDimension=function(t){return t.replace(/([^0-9.-]*)(-?[\d.]+)(.*)/,function(t,e,i,n){return""+e+Math.round(Number(i))+n})},i.isSvgImage=function(){return this.target instanceof HTMLImageElement&&(this.target.src.startsWith("data:image/")?this.target.src.includes("image/svg+xml"):this.target.src.endsWith(".svg"))},a(e,[{key:"isRelative",get:function(){var t;return(null==(t=this.target)||null==(t=t.getAttribute("width"))?void 0:t.endsWith("%"))||!1}},{key:"isAligned",get:function(){return!!this.target&&this.target.hasAttribute("data-blot-align")}}])}(d),C=/*#__PURE__*/function(t){function e(){for(var e,i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))||this).onKeyUp=function(t){var i=!!document.querySelector("div[data-blot-formatter-modal]");if(e.formatter.currentSpec&&!i&&("Delete"===t.code||"Backspace"===t.code)){var o=e.formatter.currentSpec.getTargetElement();if(o){var r=n.default.find(o);if(r){var a=e.formatter.quill.getIndex(r);e.formatter.quill.deleteText(a,1,"user")}}e.formatter.hide()}},e}l(e,t);var i=e.prototype;return i.onCreate=function(){document.addEventListener("keyup",this.onKeyUp,!0),this.formatter.quill.root.addEventListener("input",this.onKeyUp,!0)},i.onDestroy=function(){document.removeEventListener("keyup",this.onKeyUp,!0),this.formatter.quill.root.removeEventListener("input",this.onKeyUp,!0)},e}(d),S=/*#__PURE__*/function(){function t(t){this.formatter=void 0,this.isUnclickable=!1,this.formatter=t}var e=t.prototype;return e.init=function(){},e.getActions=function(){var t=[];return this.formatter.options.align.allowAligning&&t.push(new w(this.formatter)),this.formatter.options.resize.allowResizing&&t.push(new E(this.formatter)),this.formatter.options.delete.allowKeyboardDelete&&t.push(new C(this.formatter)),t},e.getTargetElement=function(){return null},e.getTargetBlot=function(){var t=this.getTargetElement();return t?n.default.find(t):null},e.getOverlayElement=function(){return this.getTargetElement()},e.setSelection=function(){this.formatter.quill.setSelection(null)},e.onHide=function(){},t}(),z=/*#__PURE__*/function(t){function e(e){var i;return(i=t.call(this,e)||this).modal=void 0,i.targetElement=null,i.onClickHandler=function(){i.showAltTitleModal()},i.toolbarButtons=[new x("attribute",i.onClickHandler,i.formatter.options.toolbar)],i.modal=i.createModal(),i}l(e,t);var i=e.prototype;return i.onCreate=function(){var t;this.targetElement=null==(t=this.formatter.currentSpec)?void 0:t.getTargetElement()},i.onDestroy=function(){this.targetElement=null,this.modal.element.remove()},i.showAltTitleModal=function(){this.targetElement&&(this.modal.altInput.value=this.targetElement.getAttribute("alt")||"",this.modal.titleInput.value=this.targetElement.getAttribute("title")||"",document.body.append(this.modal.element))},i.hideAltTitleModal=function(){this.modal.element.remove()},i.setAltTitle=function(){if(this.targetElement){var t,e=this.modal.altInput.value,i=this.modal.titleInput.value;e?this.targetElement.setAttribute("alt",e):this.targetElement.removeAttribute("alt"),i?this.targetElement.setAttribute("title",i):this.targetElement.removeAttribute("title");var o,r=n.default.find(this.targetElement),a=null==r||null==(t=r.parent)||null==(t=t.formats()[v.attrName])?void 0:t.align;r&&a&&(null==(o=r.parent)||o.format(v.attrName,!1),r.format(v.attrName,{align:a,title:i}))}},i.createModal=function(){var t,e,i=this,n=Array.from(crypto.getRandomValues(new Uint8Array(5)),function(t){return String.fromCharCode(97+t%26)}).join(""),o=document.createElement("div");o.id=n+"-modal",o.setAttribute("data-blot-formatter-modal","");var r=document.createElement("div"),a=document.createElement("form");a.id=n+"-form";var s=document.createElement("label");s.setAttribute("for","alt"),s.textContent=(null==(t=this.formatter.options.overlay.labels)?void 0:t.alt)||this.formatter.options.image.altTitleModalOptions.labels.alt;var l=document.createElement("textarea");l.name="alt",l.rows=3;var c=document.createElement("label");c.setAttribute("for","title"),c.textContent=(null==(e=this.formatter.options.overlay.labels)?void 0:e.title)||this.formatter.options.image.altTitleModalOptions.labels.title;var u=document.createElement("textarea");u.name="title",u.rows=3;var d=document.createElement("div"),h=document.createElement("button");h.type="submit",h.innerHTML=this.formatter.options.image.altTitleModalOptions.icons.submitButton,d.appendChild(h),a.appendChild(s),a.appendChild(l),a.appendChild(c),a.appendChild(u),a.appendChild(d);var m=document.createElement("button");return m.id=n+"-cancel",m.type="button",m.innerHTML=this.formatter.options.image.altTitleModalOptions.icons.cancelButton,this.formatter.options.image.altTitleModalOptions.styles&&(Object.assign(o.style,this.formatter.options.image.altTitleModalOptions.styles.modalBackground),Object.assign(r.style,this.formatter.options.image.altTitleModalOptions.styles.modalContainer),Object.assign(s.style,this.formatter.options.image.altTitleModalOptions.styles.label),Object.assign(l.style,this.formatter.options.image.altTitleModalOptions.styles.textarea),Object.assign(c.style,this.formatter.options.image.altTitleModalOptions.styles.label),Object.assign(u.style,this.formatter.options.image.altTitleModalOptions.styles.textarea),Object.assign(h.style,this.formatter.options.image.altTitleModalOptions.styles.submitButton),Object.assign(m.style,this.formatter.options.image.altTitleModalOptions.styles.cancelButton)),r.appendChild(a),r.appendChild(m),o.appendChild(r),a.addEventListener("submit",function(t){t.preventDefault(),i.setAltTitle(),i.hideAltTitleModal()}),a.addEventListener("cancel",function(){i.hideAltTitleModal()}),o.addEventListener("pointerdown",function(t){t.target===o&&i.hideAltTitleModal()}),m.addEventListener("click",function(){i.hideAltTitleModal()}),{element:o,form:a,altInput:l,titleInput:u,cancelButton:m}},e}(d),M=/*#__PURE__*/function(t){function e(e){var i;return(i=t.call(this,e)||this).options=void 0,i.modal=void 0,i.targetElement=null,i.imageDetails=null,i.onClickHandler=function(){i.showModal()},i.compressImage=function(t){if(i.imageDetails&&i.imageDetails.canCompress){var e=new Image;e.src=t.src,e.onload=function(){var n=document.createElement("canvas");n.width=i.imageDetails.targetWidth,n.height=i.imageDetails.targetHeight,n.getContext("2d").drawImage(e,0,0,n.width,n.height);var o=n.toDataURL("image/jpeg",i.options.jpegQuality),r=(new TextEncoder).encode(t.src).length;(new TextEncoder).encode(o).length<r&&(t.src=o);var a=Math.ceil((i.imageDetails.size-i.getImageSize(t))/1024)+"kB",s=i.options.text.reducedLabel+": "+a+"<br>\n                            "+i.imageDetails.naturalWidth+" x "+i.imageDetails.naturalHeight+"px → "+n.width+" x "+Math.round(n.height)+"px\n                        ";return i.displayFeedback(s),!0},e.onerror=function(t){return console.error("Image loading failed:",t),i.displayFeedback("Image loading failed: "+t),!1}}else i.displayFeedback(i.options.text.nothingToDo);return!0},i.options=i.formatter.options.image.compressorOptions,i.toolbarButtons=[new x("compress",i.onClickHandler,i.formatter.options.toolbar)],i.modal=i.createModal(),i}l(e,t);var i=e.prototype;return i.onCreate=function(){var t;this.targetElement=null==(t=this.formatter.currentSpec)?void 0:t.getTargetElement(),this.toolbarButtons[0].initialVisibility=e.isEligibleForCompression(this.targetElement)},i.onDestroy=function(){this.targetElement=null,this.hideModal()},i.showModal=function(){this.targetElement instanceof HTMLImageElement&&(this.imageDetails=this.getImageDetails(this.targetElement),this.imageDetails.canCompress?(this.modal.moreInfoButton.style.visibility="visible",this.modal.moreInfoText.style.display="none",document.body.append(this.modal.element)):this.displayFeedback(this.options.text.nothingToDo))},i.hideModal=function(){this.modal.element.remove()},e.isEligibleForCompression=function(t){if(t instanceof HTMLImageElement&&t.src.startsWith("data:image/")){var e=t.src.substring(5,t.src.indexOf(";"));return"svg+xml"!==e&&"gif"!==e}return!1},i.parseDimensions=function(t){var e=t.getAttribute("width"),i=t.getAttribute("height"),n=null,o=null;if(e)if(e.toLowerCase().endsWith("px"))n=parseFloat(e);else if(e.endsWith("%")){var r;n=null!=(r=this.options.maxWidth)?r:null}else if(e.toLowerCase().endsWith("em")||e.toLowerCase().endsWith("rem"))n=16*parseFloat(e);else{if(isNaN(parseFloat(e)))return[null,null];n=parseFloat(e)}if(i)if(isNaN(parseFloat(i)))if(i.toLowerCase().endsWith("px"))o=parseFloat(i);else if(i.toLowerCase().endsWith("em")||i.toLowerCase().endsWith("rem"))o=16*parseFloat(i);else{if(!(n&&t.naturalWidth>0&&t.naturalHeight>0))return[null,null];o=n/(t.naturalWidth/t.naturalHeight)}else o=parseFloat(i);return[n,o]},i.getImageSize=function(t){var e=t.getAttribute("src");if(!e||!e.startsWith("data:image/"))return null;var i=e.split(",")[1];return i?Math.ceil(3*i.length/4):null},i.displayFeedback=function(t){var e=this;this.formatter.sizeInfo.innerHTML=t,this.formatter.sizeInfo.style.transition="",this.formatter.sizeInfo.style.opacity="1",setTimeout(function(){e.formatter.sizeInfo.style.transition="opacity 1s",e.formatter.sizeInfo.style.opacity="0"},2500)},i.getImageDetails=function(t){var i,n=this.parseDimensions(t),o=n[0],r=n[1];return!o&&(null!=(i=this.options.maxWidth)?i:Infinity)<t.naturalWidth&&(r=(o=this.options.maxWidth)/(t.naturalWidth/t.naturalHeight)),{naturalWidth:t.naturalWidth,naturalHeight:t.naturalHeight,targetWidth:o,targetHeight:r,size:this.getImageSize(t),canCompress:!!(o&&r&&o<t.naturalWidth&&e.isEligibleForCompression(t))}},i.createModal=function(){var t=this,e=document.createElement("div");e.setAttribute("data-blot-formatter-compress-modal","");var i=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div"),r=document.createElement("div"),a=document.createElement("button"),s=document.createElement("button"),l=document.createElement("button");return o.style.display="none",r.append(a,s,l),i.append(n,o,r),e.appendChild(i),n.innerHTML=this.options.text.prompt,o.innerHTML=this.options.text.moreInfo||"",this.options.styles&&(Object.assign(e.style,this.options.styles.modalBackground),Object.assign(i.style,this.options.styles.modalContainer),Object.assign(r.style,this.options.styles.buttonContainer),Object.assign(a.style,this.options.styles.buttons),this.options.text.moreInfo?Object.assign(s.style,this.options.styles.buttons):s.style.visibility="hidden",Object.assign(l.style,this.options.styles.buttons)),a.innerHTML=this.options.icons.cancel,s.innerHTML=this.options.icons.moreInfo,l.innerHTML=this.options.icons.continue,l.addEventListener("click",function(e){t.targetElement instanceof HTMLImageElement&&t.compressImage(t.targetElement),t.hideModal()}),s.addEventListener("click",function(e){o.innerHTML=t.options.text.moreInfo||"",o.style.display="block",s.style.visibility="hidden"}),a.addEventListener("click",function(){t.hideModal()}),e.addEventListener("pointerdown",function(i){i.stopImmediatePropagation(),i.target===e&&t.hideModal()}),{element:e,moreInfoButton:s,moreInfoText:o}},e}(d),A=/*#__PURE__*/function(t){function e(e){var i;return(i=t.call(this,e)||this).img=void 0,i.onClick=function(t){var e=t.target;e instanceof HTMLImageElement&&(t.stopImmediatePropagation(),t.preventDefault(),i.img=e,i.formatter.show(i))},i.img=null,i}l(e,t);var i=e.prototype;return i.init=function(){this.formatter.quill.root.addEventListener("click",this.onClick)},i.getActions=function(){var e=t.prototype.getActions.call(this);return this.formatter.options.image.allowAltTitleEdit&&e.push(new z(this.formatter)),this.formatter.options.image.allowCompressor&&M.isEligibleForCompression(this.img)&&e.push(new M(this.formatter)),e},i.getTargetElement=function(){return this.img},i.onHide=function(){this.img=null},e}(S),T=/*#__PURE__*/function(t){function e(e){var i;return(i=t.call(this,e)||this).selector=void 0,i.unclickable=void 0,i.proxyContainer=void 0,i.unclickableProxies=void 0,i.isUnclickable=!0,i.passWheelEventThrough=function(t){i.formatter.passWheelEventThrough(t),i.repositionProxyImages()},i.onTextChange=function(){Object.entries(i.unclickableProxies).forEach(function(t){var e=t[0],n=t[1],o=n.unclickable,r=n.proxyImage;try{i.formatter.quill.root.contains(o)||(r.remove(),delete i.unclickableProxies[e])}catch(t){}}),i.formatter.quill.root.querySelectorAll(i.selector+":not([data-blot-formatter-id])").forEach(function(t){i.createUnclickableProxyImage(t)}),i.repositionProxyImages()},i.onProxyImageClick=function(t){i.unclickable=i.unclickableProxies[""+t.target.dataset.blotFormatterId].unclickable,i.formatter.show(i)},i.selector=e.options.video.selector,i.unclickable=null,i.proxyContainer=i.createProxyContainer(),i.unclickableProxies={},i}l(e,t);var i=e.prototype;return i.init=function(){var t=this;this.formatter.quill.on("text-change",this.onTextChange),this.formatter.quill.root.addEventListener("scroll",function(){t.repositionProxyImages()}),this.observeEditorResize()},i.observeEditorResize=function(){var t=this,e=null;new ResizeObserver(function(i){for(var n=function(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(i)return(i=i.call(t)).next.bind(i);if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return o(t,e);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?o(t,e):void 0}}(t))){i&&(t=i);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(i);!n().done;)e&&clearTimeout(e),e=window.setTimeout(function(){t.repositionProxyImages()},200)}).observe(this.formatter.quill.root)},i.getTargetElement=function(){return this.unclickable},i.getOverlayElement=function(){return this.unclickable},i.createUnclickableProxyImage=function(t){var e=Array.from(crypto.getRandomValues(new Uint8Array(5)),function(t){return String.fromCharCode(97+t%26)}).join("");t.dataset.blotFormatterId=e;var i=document.createElement("canvas"),n=i.getContext("2d");n&&(n.globalAlpha=0,n.fillRect(0,0,1,1));var o=document.createElement("img");o.src=i.toDataURL("image/png"),o.classList.add("blot-formatter__proxy-image"),o.dataset.blotFormatterId=e;var r=s({},this.formatter.options.video.proxyStyle,{position:"absolute",margin:"0",userSelect:"none"});Object.assign(o.style,r),o.style.setProperty("-webkit-user-select","none"),o.style.setProperty("-moz-user-select","none"),o.style.setProperty("-ms-user-select","none"),this.proxyContainer.appendChild(o),o.addEventListener("click",this.onProxyImageClick),o.addEventListener("contextmenu",function(t){t.stopPropagation(),t.preventDefault()}),o.addEventListener("wheel",this.formatter.passWheelEventThrough),o.addEventListener("touchstart",this.formatter.onTouchScrollStart,{passive:!1}),o.addEventListener("touchmove",this.formatter.onTouchScrollMove,{passive:!1}),this.unclickableProxies[e]={unclickable:t,proxyImage:o}},i.repositionProxyImages=function(){if(Object.keys(this.unclickableProxies).length>0){var t=this.formatter.quill.container.getBoundingClientRect(),e=this.formatter.quill.container.scrollLeft,i=this.formatter.quill.container.scrollTop;Object.entries(this.unclickableProxies).forEach(function(n){var o=n[0],r=n[1],a=r.unclickable,s=r.proxyImage;try{var l=a.getBoundingClientRect();Object.assign(s.style,{left:l.left-t.left-1+e+"px",top:l.top-t.top+i+"px",width:l.width+"px",height:l.height+"px"})}catch(t){console.error("Error positioning proxy image with id "+o+": ",""+(t instanceof Error?t.message:t))}})}},i.createProxyContainer=function(){var t=document.createElement("div");return t.classList.add("proxy-container"),this.formatter.quill.container.appendChild(t),t},e}(S),k=/*#__PURE__*/function(t){function e(e){return t.call(this,e)||this}return l(e,t),e}(T),I={specs:[A,k],overlay:{className:"blot-formatter__overlay",style:{position:"absolute",boxSizing:"border-box",border:"1px dashed #444",backgroundColor:"rgba(255, 255, 255, 0.35)",maxWidth:"100%"},sizeInfoStyle:{position:"absolute",color:"rgba(255, 255, 255, 0.7)",backgroundColor:"rgba(0, 0, 0, 0.7)",top:"50%",left:"50%",transform:"translate(-50%, -50%)",padding:"1em",textWrap:"nowrap",fontSize:"1rem",opacity:0,lineHeight:1.2}},align:{allowAligning:!0,alignments:["left","center","right"]},resize:{allowResizing:!0,allowResizeModeChange:!1,imageOversizeProtection:!1,handleClassName:"blot-formatter__resize-handle",handleStyle:{position:"absolute",height:"12px",width:"12px",backgroundColor:"white",border:"1px solid #777",boxSizing:"border-box",opacity:"0.80"},useRelativeSize:!1,minimumWidthPx:25},delete:{allowKeyboardDelete:!0},toolbar:{icons:{left:'\n        <svg viewbox="0 0 18 18">\n          <line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"></line>\n          <line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"></line>\n          <line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"></line>\n        </svg>\n      ',center:'\n        <svg viewbox="0 0 18 18">\n          <line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"></line>\n          <line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"></line>\n          <line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"></line>\n        </svg>\n      ',right:'\n        <svg viewbox="0 0 18 18">\n          <line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"></line>\n          <line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"></line>\n          <line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"></line>\n        </svg>\n      ',attribute:'\n        <svg viewBox="0 0 24 24" fill="none" class="ql-stroke">\n          <path d="M10 19H12M12 19H14M12 19V5M12 5H6V6M12 5H18V6" stroke-linecap="round" stroke-linejoin="round"/>\n        </svg>\n      ',resizeMode:'\n        <svg viewBox="0 0 24 24" class="ql-stroke">\n          <path\n            d="m 7.7056591,11.853515 q -1.515179,0 -2.4160962,-0.993056 -0.9009172,-1.0032944 -0.9009172,-2.6720388 0,-1.8223098 0.9521057,-2.8665548 0.9521057,-1.0544826 2.5696616,-1.0544826 1.5663674,0 2.426334,0.9725811 0.870204,0.972581 0.870204,2.7334647 0,1.7608836 -0.972581,2.8256044 -0.9623435,1.054482 -2.5287109,1.054482 z M 7.8489868,5.3935293 q -0.9725811,0 -1.5356544,0.7268764 -0.5630732,0.7166387 -0.5630732,1.9758752 0,1.2387612 0.5528356,1.9349241 0.5528355,0.685926 1.5049412,0.685926 0.9623434,0 1.5049413,-0.716639 0.5425978,-0.7166384 0.5425978,-1.9861126 0,-1.2387612 -0.5425978,-1.9246868 Q 8.7806171,5.3935293 7.8489868,5.3935293 Z M 17.533847,4.4926121 8.1151669,19.275845 H 6.6511764 L 16.059619,4.4926121 Z M 16.448651,19.398697 q -1.515179,0 -2.416096,-1.003294 -0.900917,-1.003294 -0.900917,-2.661801 0,-1.82231 0.962343,-2.876793 0.962344,-1.06472 2.559424,-1.06472 1.55613,0 2.426334,0.982819 0.870204,0.982819 0.870204,2.75394 0,1.750646 -0.972581,2.815366 -0.962343,1.054483 -2.528711,1.054483 z m 0.143328,-6.449748 q -0.982819,0 -1.545892,0.716638 -0.552836,0.716639 -0.552836,1.986113 0,1.218286 0.552836,1.914449 0.552835,0.685926 1.504941,0.685926 0.962343,0 1.504941,-0.716639 0.542598,-0.726876 0.542598,-1.986113 0,-1.248998 -0.542598,-1.924686 -0.53236,-0.675688 -1.46399,-0.675688 z"\n            style="fill:currentColor;stroke:currentColor;stroke-width:0.3"\n          />\n        </svg>\n      ',compress:'\n        <svg viewBox="0 0 28 28">\n            <path d="m 19.250001,9.3125004 c 0.240623,0 0.437498,0.1968749 0.437498,0.4374991 V 18.49453 l -0.136717,-0.177734 -3.718751,-4.812498 c -0.123046,-0.161329 -0.317188,-0.254297 -0.51953,-0.254297 -0.202345,0 -0.39375,0.09297 -0.519532,0.254297 l -2.269532,2.936715 -0.833984,-1.167577 c -0.123047,-0.172265 -0.319922,-0.273437 -0.533204,-0.273437 -0.213281,0 -0.410156,0.101172 -0.533202,0.276172 l -2.1875003,3.0625 -0.1230462,0.169532 v -0.0082 -8.7500002 c 0,-0.2406242 0.1968749,-0.4374991 0.4374991,-0.4374991 z M 8.7499996,8 C 7.7847663,8 7,8.7847662 7,9.7499995 V 18.5 c 0,0.965233 0.7847663,1.75 1.7499996,1.75 H 19.250001 C 20.215235,20.25 21,19.465233 21,18.5 V 9.7499995 C 21,8.7847662 20.215235,8 19.250001,8 Z M 10.9375,13.250001 a 1.3125025,1.312501 0 1 0 0,-2.625002 1.3125025,1.312501 0 1 0 0,2.625002 z" />\n            <path d="m 25.298508,20 h -3.58209 C 21.286567,20 21,20.286571 21,20.716427 v 3.582131 c 0,0.429856 0.286567,0.716426 0.716418,0.716426 v 0 c 0.429851,0 0.716418,-0.28657 0.716418,-0.716426 v -2.865705 h 2.865672 c 0.429851,0 0.716418,-0.28657 0.716418,-0.716426 C 26.014926,20.286571 25.728359,20 25.298508,20 Z" />\n            <path d="M 6.298508,20 H 2.716418 C 2.2865673,20 2,20.286571 2,20.716427 c 0,0.429856 0.2865673,0.716426 0.716418,0.716426 H 5.58209 v 2.865705 c 0,0.429856 0.286567,0.716426 0.716418,0.716426 v 0 c 0.429851,0 0.716418,-0.28657 0.716418,-0.716426 V 20.716427 C 7.014926,20.286571 6.728359,20 6.298508,20 Z" />\n            <path d="M 6.298507,3 C 5.868656,3 5.582089,3.28657 5.582089,3.716426 V 6.582131 H 2.716417 C 2.286567,6.582131 2,6.868702 2,7.298557 2,7.728413 2.286567,8.014984 2.716417,8.014984 h 3.58209 c 0.429845,0 0.716412,-0.286571 0.716412,-0.716427 V 3.716426 C 7.014919,3.28657 6.728352,3 6.298507,3 Z" />\n            <path d="m 21.716418,8.014984 h 3.582089 c 0.429851,0 0.716418,-0.286571 0.716418,-0.716427 0,-0.429855 -0.286567,-0.716426 -0.716418,-0.716426 H 22.432836 V 3.716426 C 22.432836,3.28657 22.146269,3 21.716418,3 21.286567,3 21,3.28657 21,3.716426 v 3.582131 c 0,0.429856 0.286567,0.716427 0.716418,0.716427 z" />\n        </svg>\n      '},mainClassName:"blot-formatter__toolbar",mainStyle:{position:"absolute",display:"flex",top:"0",right:"0",left:"0",transform:"translateY(-50%)",justifyContent:"center",flexWrap:"wrap",color:"#333",zIndex:"1"},buttonClassName:"blot-formatter__toolbar-button",buttonStyle:{display:"inline-block",width:"27px",height:"26px",background:"white",border:"1px solid #999",cursor:"pointer",margin:"0 -1px 0 0"},svgStyle:{display:"inline-block",width:"100%",height:"100%",background:"white",verticalAlign:"top"}},image:{allowAltTitleEdit:!0,registerImageTitleBlot:!1,registerArrowRightFix:!0,altTitleModalOptions:{styles:{modalBackground:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},modalContainer:{backgroundColor:"#f2f2f2",padding:"5px 10px 10px 10px",borderRadius:"5px",position:"relative",width:"90%",maxWidth:"500px"},label:{display:"block",color:"black",margin:"10px 0 5px 0",fontSize:"0.9em"},textarea:{backgroundColor:"white",display:"block",resize:"none",width:"100%",padding:"5px"},submitButton:{display:"block",marginLeft:"auto",marginTop:"5px",cursor:"pointer",border:0,padding:0,width:"2.5rem",height:"2.5rem",fill:"green"},cancelButton:{display:"flex",width:"2rem",height:"2rem",position:"absolute",top:"-0.7rem",right:"-0.7rem",background:"white",border:"1px solid gray",borderRadius:"5px",cursor:"pointer",alignItems:"center",fill:"red"}},icons:{submitButton:'\n        <svg viewBox="0 0 24 24">\n          <path fill-rule="evenodd" clip-rule="evenodd" d="M12 22C7.28595 22 4.92893 22 3.46447 20.5355C2 19.0711 2 16.714 2 12C2 7.28595 2 4.92893 3.46447 3.46447C4.92893 2 7.28595 2 12 2C16.714 2 19.0711 2 20.5355 3.46447C22 4.92893 22 7.28595 22 12C22 16.714 22 19.0711 20.5355 20.5355C19.0711 22 16.714 22 12 22ZM16.0303 8.96967C16.3232 9.26256 16.3232 9.73744 16.0303 10.0303L11.0303 15.0303C10.7374 15.3232 10.2626 15.3232 9.96967 15.0303L7.96967 13.0303C7.67678 12.7374 7.67678 12.2626 7.96967 11.9697C8.26256 11.6768 8.73744 11.6768 9.03033 11.9697L10.5 13.4393L14.9697 8.96967C15.2626 8.67678 15.7374 8.67678 16.0303 8.96967Z"></path>\n        </svg>',cancelButton:'\n        <svg viewBox="0 0 384 512">   \n            <path d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"/>\n        </svg>'},labels:{alt:"Alt Text",title:"Image Title"}},allowCompressor:!1,compressorOptions:{jpegQuality:.8,styles:{modalBackground:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},modalContainer:{backgroundColor:"#000000c7",padding:"15px",borderRadius:"8px",position:"relative",maxWidth:"min(90%, 400px)",border:"3px solid black",color:"lightgray",textAlign:"justify",userSelect:"none"},buttonContainer:{gridTemplateColumns:"auto 1fr auto",display:"grid",gap:"1em",justifyItems:"center",borderTop:"1px solid lightgray",paddingTop:"12px"},buttons:{width:"2rem",height:"2rem",padding:0,backgroundColor:"transparent",border:0,cursor:"pointer"}},text:{prompt:"<h5>Compress image to its resized width?</h5>",moreInfo:'\n              <p style="font-size: smaller; line-height: 1.2;">You can reduce the file size and save disk space by compressing pictures. The compression reduces both\n              the file size and picture dimensions based on the width setting.</p>\n              <p style="font-size: smaller;"><strong>NOTE:</strong> This process cannot be undone.</p>\n          ',reducedLabel:"Reduced",nothingToDo:"Image already optimised."},icons:{cancel:'\n              <svg viewBox="0 0 24 24" fill="#ea1414">\n                  <path d="M 3.4285714,0 C 1.5375,0 0,1.5375 0,3.4285714 V 20.571429 C 0,22.4625 1.5375,24 3.4285714,24 H 20.571429 C 22.4625,24 24,22.4625 24,20.571429 V 3.4285714 C 24,1.5375 22.4625,0 20.571429,0 Z m 4.2321429,7.6607143 c 0.5035714,-0.5035714 1.3178571,-0.5035714 1.8160714,0 L 11.994643,10.178571 14.5125,7.6607143 c 0.503571,-0.5035714 1.317857,-0.5035714 1.816071,0 0.498215,0.5035714 0.503572,1.3178571 0,1.8160714 l -2.517857,2.5178573 2.517857,2.517857 c 0.503572,0.503571 0.503572,1.317857 0,1.816071 -0.503571,0.498215 -1.317857,0.503572 -1.816071,0 l -2.517857,-2.517857 -2.5178573,2.517857 c -0.5035714,0.503572 -1.3178571,0.503572 -1.8160714,0 C 7.1625,15.825 7.1571429,15.010714 7.6607143,14.5125 L 10.178571,11.994643 7.6607143,9.4767857 c -0.5035714,-0.5035714 -0.5035714,-1.3178571 0,-1.8160714 z" />\n              </svg>',moreInfo:'\n              <svg viewBox="0 0 512 512" fill="royalblue">\n                  <path d="M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm169.8-90.7c7.9-22.3 29.1-37.3 52.8-37.3l58.3 0c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24l0-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1l-58.3 0c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z" />\n              </svg>',continue:'\n              <svg viewBox="0 0 24 24" fill="green">\n                  <path fill-rule="evenodd" clip-rule="evenodd"\n                      d="M 12,24 C 6.34314,24 3.514716,24 1.757364,22.2426 0,20.48532 0,17.6568 0,12 0,6.34314 0,3.514716 1.757364,1.757364 3.514716,0 6.34314,0 12,0 17.6568,0 20.48532,0 22.2426,1.757364 24,3.514716 24,6.34314 24,12 24,17.6568 24,20.48532 22.2426,22.2426 20.48532,24 17.6568,24 12,24 Z M 16.83636,8.363604 c 0.35148,0.351468 0.35148,0.921324 0,1.272756 l -6,6 c -0.35148,0.35148 -0.92124,0.35148 -1.272756,0 l -2.4,-2.4 c -0.351468,-0.35148 -0.351468,-0.92124 0,-1.27272 0.351468,-0.35148 0.921324,-0.35148 1.272792,0 L 10.2,13.72716 15.56364,8.363604 c 0.35148,-0.351468 0.92124,-0.351468 1.27272,0 z" />\n              </svg>'}}},video:{selector:"iframe.ql-video",registerCustomVideoBlot:!1,registerBackspaceFix:!0,defaultAspectRatio:"16/9 auto",proxyStyle:{}}},L=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===O}(t)}(t)},O="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function H(t,e){return!1!==e.clone&&e.isMergeableObject(t)?q(Array.isArray(t)?[]:{},t,e):t}function R(t,e,i){return t.concat(e).map(function(t){return H(t,i)})}function B(t){return Object.keys(t).concat(function(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return Object.propertyIsEnumerable.call(t,e)}):[]}(t))}function W(t,e){try{return e in t}catch(t){return!1}}function q(t,e,i){(i=i||{}).arrayMerge=i.arrayMerge||R,i.isMergeableObject=i.isMergeableObject||L,i.cloneUnlessOtherwiseSpecified=H;var n=Array.isArray(e);return n===Array.isArray(t)?n?i.arrayMerge(t,e,i):function(t,e,i){var n={};return i.isMergeableObject(t)&&B(t).forEach(function(e){n[e]=H(t[e],i)}),B(e).forEach(function(o){(function(t,e){return W(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))})(t,o)||(n[o]=W(t,o)&&i.isMergeableObject(e[o])?function(t,e){if(!e.customMerge)return q;var i=e.customMerge(t);return"function"==typeof i?i:q}(o,i)(t[o],e[o],i):H(e[o],i))}),n}(t,e,i):H(e,i)}q.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(t,i){return q(t,i,e)},{})};var j=q,P=n.default.import("formats/image"),D=["alt","height","width","title"],N=/*#__PURE__*/function(t){function e(){return t.apply(this,arguments)||this}return l(e,t),e.formats=function(t){return D.reduce(function(e,i){return t.hasAttribute(i)&&(e[i]=t.getAttribute(i)),e},{})},e.prototype.format=function(e,i){D.indexOf(e)>-1?i?this.domNode.setAttribute(e,i):this.domNode.removeAttribute(e):t.prototype.format.call(this,e,i)},e}(P),U=/*#__PURE__*/function(t){function e(){return t.apply(this,arguments)||this}return l(e,t),e.create=function(e){var i=t.create.call(this,e);return i.setAttribute("width","100%"),i.style.aspectRatio=this.aspectRatio,i},e.prototype.html=function(){return this.domNode.outerHTML},e}(n.default.import("formats/video"));U.aspectRatio="16 / 9 auto";var F=/*#__PURE__*/function(){function t(t){this.formatter=void 0,this.element=void 0,this.buttons={},this.formatter=t,this.element=document.createElement("div"),this.element.classList.add(this.formatter.options.toolbar.mainClassName),this.element.addEventListener("mousedown",function(t){t.stopPropagation()}),this.formatter.options.toolbar.mainStyle&&Object.assign(this.element.style,this.formatter.options.toolbar.mainStyle)}var e=t.prototype;return e.create=function(){var t,e=this,i=[];this.formatter.actions.forEach(function(t){t.toolbarButtons.forEach(function(t){e.buttons[t.action]=t,i.push(t.create())})}),(t=this.element).append.apply(t,i),this.formatter.overlay.append(this.element)},e.destroy=function(){this.element&&this.formatter.overlay.removeChild(this.element);for(var t=0,e=Object.values(this.buttons);t<e.length;t++)e[t].destroy();this.buttons={},this.element.innerHTML=""},t}(),V=function(t,e){return e},_=/*#__PURE__*/function(){function t(t,e){var i=this;if(void 0===e&&(e={}),this.quill=void 0,this.options=void 0,this.currentSpec=void 0,this.specs=void 0,this.overlay=void 0,this.toolbar=void 0,this.sizeInfo=void 0,this.actions=void 0,this.startX=0,this.startY=0,this.onDocumentPointerDown=function(t){var e=t.target;i.quill.root.parentNode.contains(e)||e.closest("div[data-blot-formatter-modal]")||e.classList.contains("blot-formatter__proxy-image")||i.hide()},this.onClick=function(){i.hide()},this.passWheelEventThrough=function(t){i.quill.root.scrollLeft+=t.deltaX,i.quill.root.scrollTop+=t.deltaY},this.onTouchScrollStart=function(t){if(1===t.touches.length){var e=t.touches[0];i.startX=e.clientX,i.startY=e.clientY}},this.onTouchScrollMove=function(t){if(1===t.touches.length){var e=t.touches[0],n=i.startX-e.clientX,o=i.startY-e.clientY,r=i.quill.root,a=0===r.scrollTop,s=r.scrollTop+r.clientHeight===r.scrollHeight,l=0===r.scrollLeft,c=r.scrollLeft+r.clientWidth===r.scrollWidth,u=Math.abs(o)>Math.abs(n),d=Math.abs(n)>Math.abs(o),h=!1;u&&(a&&o<0||s&&o>0||(h=!0,r.scrollTop+=o)),d&&(l&&n<0||c&&n>0||(h=!0,r.scrollLeft+=n)),h&&t.preventDefault(),i.startX=e.clientX,i.startY=e.clientY}},this.onOverlayTouchScrollMove=function(t){i.onTouchScrollMove(t),i.repositionOverlay()},this.quill=t,this.currentSpec=null,this.actions=[],t.options.readOnly)return this.options=I,this.toolbar=new F(this),this.specs=[],this.overlay=document.createElement("div"),void(this.sizeInfo=document.createElement("div"));this.options=j(I,e,{arrayMerge:V});var n=this.createOverlay();this.overlay=n[0],this.sizeInfo=n[1],this.addEventListeners(),this.toolbar=new F(this),this.specs=this.options.specs.map(function(t){return new t(i)}),this.specs.forEach(function(t){return t.init()}),document.execCommand("enableObjectResizing",!1,"false"),this.quill.container.style.position=this.quill.container.style.position||"relative",this.registerCustomBlots(),this.keyboardBindings()}var e=t.prototype;return e.show=function(t){this.hide(),this.currentSpec=t,this.currentSpec.setSelection(),this.setUserSelect("none"),this.quill.container.appendChild(this.overlay),this.repositionOverlay(),this.createActions(t),this.toolbar.create(),document.addEventListener("pointerdown",this.onDocumentPointerDown)},e.hide=function(){this.currentSpec&&(this.currentSpec.onHide(),this.currentSpec=null,this.quill.container.removeChild(this.overlay),document.removeEventListener("pointerdown",this.onDocumentPointerDown),this.overlay.style.setProperty("display","none"),this.setUserSelect(""),this.destroyActions(),this.toolbar.destroy(),this.quill.emitter.emit(this.quill.constructor.events.TEXT_CHANGE,0,this.quill.getLength(),"api"))},e.update=function(){this.repositionOverlay(),this.actions.forEach(function(t){return t.onUpdate()})},e.createActions=function(t){this.actions=t.getActions().map(function(t){return t.onCreate(),t})},e.destroyActions=function(){this.actions.forEach(function(t){return t.onDestroy()}),this.actions=[]},e.createOverlay=function(){var t=document.createElement("div");t.classList.add(this.options.overlay.className),this.options.overlay.style&&Object.assign(t.style,this.options.overlay.style),t.style.userSelect="none",t.style.setProperty("-webkit-user-select","none"),t.style.setProperty("-moz-user-select","none"),t.style.setProperty("-ms-user-select","none");var e=document.createElement("div");return this.options.overlay.sizeInfoStyle&&Object.assign(e.style,this.options.overlay.sizeInfoStyle),t.appendChild(e),[t,e]},e.addEventListeners=function(){var t=this;this.overlay.addEventListener("wheel",this.passWheelEventThrough,{passive:!1}),this.overlay.addEventListener("touchstart",this.onTouchScrollStart,{passive:!1}),this.overlay.addEventListener("touchmove",this.onTouchScrollMove,{passive:!1}),this.overlay.addEventListener("contextmenu",function(t){t.stopPropagation(),t.preventDefault()}),this.repositionOverlay=this.repositionOverlay.bind(this),this.quill.root.addEventListener("scroll",this.repositionOverlay),new ResizeObserver(function(){t.repositionOverlay()}).observe(this.quill.root),this.quill.root.addEventListener("click",this.onClick)},e.repositionOverlay=function(){if(this.currentSpec){var t=this.currentSpec.getOverlayElement();if(t){var e=this.quill.container.getBoundingClientRect(),i=t.getBoundingClientRect();Object.assign(this.overlay.style,{display:"block",left:i.left-e.left-1+this.quill.container.scrollLeft+"px",top:i.top-e.top+this.quill.container.scrollTop+"px",width:i.width+"px",height:i.height+"px"})}}},e.setUserSelect=function(t){var e=this;["userSelect","mozUserSelect","webkitUserSelect","msUserSelect"].forEach(function(i){e.quill.root.style.setProperty(i,t),document.documentElement&&document.documentElement.style.setProperty(i,t)})},e.registerCustomBlots=function(){this.options.image.registerImageTitleBlot&&n.default.register(N,!0),this.options.video.registerCustomVideoBlot&&(U.aspectRatio=this.options.video.defaultAspectRatio,n.default.register(U,!0))},e.keyboardBindings=function(){var t=this;this.options.video.registerBackspaceFix&&(this.quill.keyboard.bindings.Backspace||(this.quill.keyboard.bindings.Backspace=[]),this.quill.keyboard.bindings.Backspace.unshift({key:"Backspace",empty:!0,line:{domNode:{tagName:"IFRAME"}},handler:function(e){t.quill.deleteText(e.index-1,1,"user")}})),this.options.image.registerArrowRightFix&&(this.quill.keyboard.bindings.ArrowRight||(this.quill.keyboard.bindings.ArrowRight=[]),this.quill.keyboard.bindings.ArrowRight.unshift({key:"ArrowRight",collapsed:!0,empty:!1,suffix:/^$/,line:{domNode:{tagName:"P"}},handler:function(e,i){t.quill.setSelection(e.index+e.length+1,0,"user")}}))},e.useRelative=function(t){if(this.options.resize.allowResizeModeChange){var e=t.getAttribute("width");return e?e.endsWith("%"):this.options.resize.useRelativeSize}return this.options.resize.useRelativeSize},t}();t.Action=d,t.AlignAction=w,t.AttributeAction=z,t.BlotSpec=S,t.DefaultAligner=b,t.DefaultOptions=I,t.DeleteAction=C,t.IframeVideoSpec=k,t.ImageSpec=A,t.ResizeAction=E,t.Toolbar=F,t.ToolbarButton=x,t.UnclickableBlotSpec=T,t.default=_});
